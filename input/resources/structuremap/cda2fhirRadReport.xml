<StructureMap xmlns="http://hl7.org/fhir">
   <id value="cda2fhirRadReport"/>
   <text>
      <status value="generated"/>
      <div xmlns="http://www.w3.org/1999/xhtml">
         <pre>map &quot;http://hl7.it/fhir/cda2fhir/StructureMap/cda2fhirRadReport&quot; = &quot;cda2fhirRadReport&quot;


conceptmap &quot;OBSstatus&quot; {
  prefix s = &quot;http://terminology.hl7.org/ValueSet/v3-statusCode&quot;
  prefix t = &quot;http://hl7.org/fhir/status.html&quot;

  s:completed == t:final
  s:active == t:registered
  s:aborted == t:cancelled
  s:suspended == t:partial
}

conceptmap &quot;cm-v3-administrative-gender&quot; {
  prefix s = &quot;http://terminology.hl7.org/ValueSet/v3-AdministrativeGender&quot;
  prefix t = &quot;http://hl7.org/fhir/ValueSet/administrative-gender&quot;

  s:M == t:male
  s:F == t:female
}

conceptmap &quot;AllergyTypeMap&quot; {
  prefix s = &quot;http://terminology.hl7.org/ValueSet/v3-type&quot;
  prefix t = &quot;http://hl7.org/fhir/Allergy-type.html&quot;

  s:OINT == t:intolerance
  s:ALG == t:allergy
  s:DALG == t:allergy
  s:EALG == t:allergy
  s:FALG == t:allergy
  s:NAINT == t:intolerance
  s:FNAINT == t:intolerance
  s:DNAINT == t:intolerance
  s:ENAINT == t:intolerance
  s:FINT == t:intolerance
  s:DINT == t:intolerance
  s:EINT == t:intolerance
}

conceptmap &quot;AllergyCategoryMap&quot; {
  prefix s = &quot;http://terminology.hl7.org/ValueSet/v3-type&quot;
  prefix t = &quot;http://hl7.org/fhir/Allergy-type.html&quot;

  s:DALG == t:medication
  s:EALG == t:enviroment
  s:FALG == t:food
  s:FNAINT == t:intolerance
  s:DNAINT == t:medication
  s:ENAINT == t:enviroment
  s:FINT == t:food
  s:DINT == t:medication
  s:EINT == t:enviroment
}

conceptmap &quot;CricalityMap&quot; {
  prefix s = &quot;http://terminology.hl7.org/CodeSystem/v3-ObservationValue&quot;
  prefix t = &quot;http://hl7.org/fhir/allergy-intolerance-criticality&quot;

  s:M == t:low
  s:H == t:high
  s:L == t:low
}

uses &quot;http://hl7.org/fhir/cda/StructureDefinition/ClinicalDocument&quot; alias ClinicalDocument as source
uses &quot;http://hl7.org/fhir/cda/StructureDefinition/AssignedAuthor&quot; alias AssignedAuthor as queried
uses &quot;http://hl7.org/fhir/cda/StructureDefinition/AssignedEntity&quot; alias AssignedEntity as queried
uses &quot;http://hl7.org/fhir/cda/StructureDefinition/AssociatedEntity&quot; alias AssociatedEntity as queried
uses &quot;http://hl7.org/fhir/cda/StructureDefinition/CustodianOrganization&quot; alias CustodianOrganization as queried
uses &quot;http://hl7.org/fhir/cda/StructureDefinition/OrganizationPartOf&quot; alias OrganizationPartOf as queried
uses &quot;http://hl7.org/fhir/cda/StructureDefinition/Organization&quot; alias rapresentedOrganization as queried
uses &quot;http://hl7.org/fhir/cda/StructureDefinition/Section&quot; alias Section as queried
uses &quot;http://hl7.org/fhir/cda/StructureDefinition/PatientRole&quot; alias PatientRole as queried
uses &quot;http://hl7.org/fhir/cda/StructureDefinition/AD&quot; alias AD as source
uses &quot;http://hl7.org/fhir/StructureDefinition/Bundle&quot; alias Bundle as target
uses &quot;http://hl7.org/fhir/StructureDefinition/Composition&quot; alias Composition as produced
uses &quot;http://hl7.org/fhir/StructureDefinition/Patient&quot; alias Patient as produced
uses &quot;http://hl7.org/fhir/StructureDefinition/Encounter&quot; alias Encounter as produced
uses &quot;http://hl7.org/fhir/StructureDefinition/Person&quot; alias Patient as produced
uses &quot;http://hl7.org/fhir/StructureDefinition/List&quot; alias List as produced
uses &quot;http://hl7.org/fhir/StructureDefinition/Practitioner&quot; alias Practitioner as produced
uses &quot;http://hl7.org/fhir/StructureDefinition/Organization&quot; alias Organization as produced
uses &quot;http://hl7.org/fhir/cda/StructureDefinition/Act&quot; alias Act as produced
uses &quot;http://hl7.org/fhir/cda/StructureDefinition/IVL-PQ&quot; alias IVL_PQ as source
uses &quot;http://hl7.org/fhir/cda/StructureDefinition/PQ&quot; alias PQ as source
uses &quot;http://hl7.org/fhir/StructureDefinition/SimpleQuantity&quot; alias SimpleQuantity as target

imports &quot;http://hl7.it/fhir/cda2fhir/StructureMap/cda2fhirDataTypes&quot;
imports &quot;http://hl7.it/fhir/cda2fhir/StructureMap/cda2fhirHeader&quot;

group CdaToBundle(source cda : ClinicalDocument, target bundle : Bundle) {
  cda -&gt;  bundle.entry as e,  e.request = create(&apos;BackboneElement&apos;) as request,  request.method = &apos;POST&apos;,  e.resource = create(&apos;Composition&apos;) as composition,  composition.id = uuid() as uuid1,  e.fullUrl = append(&apos;https://example/Composition/&apos;, uuid1),  request.url = &apos;Composition',  bundle.entry as e2,  e2.request = create('BackboneElement') as requestPAT,  requestPAT.method = 'PUT',  e2.resource = create('Patient') as patient,  patient.id = uuid() as uuid2,  e2.fullUrl = append('https://example/Patient/', uuid2),  bundle.entry as e3,  e3.request = create('BackboneElement') as request,  request.method = 'POST',  e3.resource = create('Encounter') as encounter,  encounter.id = uuid() as uuid3,  e3.fullUrl = append('https://example/Encounter/', uuid3),  request.url = 'Encounter',  bundle.entry as e4,  e4.request = create(&apos;BackboneElement&apos;) as request,  request.method = &apos;POST&apos;,  e4.resource = create(&apos;DocumentReference&apos;) as DocumentReference,  DocumentReference.id = uuid() as uuid4,  e4.fullUrl = append(&apos;https://example/DocumentReference/&apos;, uuid4),  request.url = &apos;DocumentReference&apos; then {
    cda then ClinicalDocumentToBundle(cda, patient, composition, encounter, bundle, DocumentReference) &quot;cdatobundle&quot;;
    cda.recordTarget as recordTarget then {
      recordTarget.patientRole as patient then {
        patient.id as id -&gt; patient.identifier as identifier then {
          id.root as r -&gt; identifier.system = translate(r, &apos;http://hl7.org/fhir/ConceptMap/special-oid2uri&apos;, &apos;uri&apos;) &quot;root1&quot;;
          id.extension as ext1 -&gt; identifier.value = ext1 &quot;value&quot;;
          id.assigningAuthorityName as s -&gt;  identifier.assigner as a,  a.display = s;
        } &quot;idfr&quot;;
        patient.id as id where (root = &apos;2.16.840.1.113883.2.9.4.3.2&apos;) or (root = &apos;2.16.840.1.113883.2.9.4.3.7&apos;) or (root = &apos;2.16.840.1.113883.2.9.4.3.3&apos;) or (root = &apos;2.16.840.1.113883.2.9.4.3.17&apos;) or (root = &apos;2.16.840.1.113883.2.9.4.3.15&apos;) then {
          id.extension as ext -&gt; requestPAT.url = append(&apos;Patient?identifier=&apos;, ext) &quot;UUID&quot;;
        } &quot;record&quot;;
      } &quot;recPat&quot;;
    } &quot;patient&quot;;
  } &quot;ClinicalDocumentToBody&quot;;
}

group ClinicalDocumentToBundle(source cda : ClinicalDocument, target patient : Patient, target composition : Composition, target encounter : Encounter, target bundle : Bundle, target DocumentReference : DocumentReference) {
  cda -&gt; bundle.id = uuid() &quot;id&quot;;
  cda.id -&gt; bundle.identifier &quot;identifier&quot;;
  cda -&gt; bundle.type = &apos;transaction&apos; &quot;type&quot;;
  cda.effectiveTime -&gt; bundle.timestamp;
  cda then ClinicalDocumentComposition(cda, composition, patient, encounter, bundle, DocumentReference) &quot;composition&quot;;
  cda -&gt;  bundle.entry as e,  e.request = create(&apos;BackboneElement&apos;) as request,  request.method = &apos;POST&apos;,  e.resource = create(&apos;DiagnosticReport&apos;) as diagnosticReport,  diagnosticReport.id = uuid() as uuid1,  e.fullUrl = append(&apos;https://example/DiagnosticReport/&apos;, uuid1),  request.url = &apos;DiagnosticReport&apos; then {
    cda.code -&gt; diagnosticReport.code &quot;diagnosticCode&quot;;
    cda -&gt; diagnosticReport.status = &apos;registered&apos; &quot;stats&quot;;
    cda.component as component then {
      component.structuredBody as body then {
        body.component as component then {
          component.section as srcSection then {
            srcSection.code -&gt; composition.section as tgtSection then ClinicalDocumentSection(cda, srcSection, patient, tgtSection, bundle, encounter, diagnosticReport);
          };
        };
      } &quot;body&quot;;
    };
  } &quot;diagnostic&quot;;
}

group ClinicalDocumentSection(source cda : ClinicalDocument, source src : Section, target patient : Patient, target tgt, target bundle : Bundle, target enc : Encounter, target dReport : DiagnosticReport) {
  src.title as t -&gt; tgt.title = (t.dataString);
  src.code -&gt; tgt.code;
  src -&gt;  tgt.entry = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/DiagnosticReport/&apos; + %dReport.id) &quot;reference&quot;;
  src.entry as entry then {
    src.text as cdaText -&gt; tgt.text as fhirText then {
      cdaText -&gt; fhirText.status = &apos;generated&apos; &quot;narrativeStatus&quot;;
      cdaText as t -&gt; fhirText.div = t &quot;narrativeText&quot;;
    } &quot;cdaText&quot;;
    entry then DiagnosticReportFunction(src, entry, dReport, bundle, enc, patient) &quot;dreport&quot;;
  };
  src where src.entry.exists().not() then DiagnosticReportFunction(src, cda, dReport, bundle, enc, patient) &quot;narrative&quot;;
  src.component as component then {
    component.section as sec -&gt; tgt.section as tgtSection then ClinicalDocumentSection(cda, sec, patient, tgtSection, bundle, enc, dReport);
  };
}

group DiagnosticReportFunction(source section : section, source src : entry, target dReport : DiagnosticReport, target bundle : Bundle, target encounter : Encounter, target patient : Patient) {
  src.act as act1 then {
    section where (code.code = &apos;121181&apos;) -&gt;  bundle.entry as e1,  e1.request = create(&apos;BackboneElement&apos;) as request,  request.method = &apos;POST&apos;,  e1.resource = create(&apos;ImagingStudy&apos;) as imageS,  imageS.id = uuid() as uuid1,  e1.fullUrl = append(&apos;https://example/ImagingStudy/&apos;, uuid1),  request.url = &apos;ImagingStudy&apos;,  dReport.imagingStudy = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/ImagingStudy/&apos; + %imageS.id) then ImagingStudy(act1, section, imageS, patient, encounter) &quot;imagingStudy&quot;;
    section where (code.code = &apos;48765-2&apos;) -&gt;  bundle.entry as e2,  e2.request = create(&apos;BackboneElement&apos;) as request,  request.method = &apos;POST&apos;,  e2.resource = create(&apos;Observation&apos;) as obs1,  obs1.id = uuid() as uuid2,  e2.fullUrl = append(&apos;https://example/Observation/&apos;, uuid2),  request.url = &apos;Observation&apos;,  dReport.result = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Observation/&apos; + %obs1.id) then {
      section -&gt;  obs1.subject = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Patient/&apos; + %patient.id) &quot;reference&quot;;
      section -&gt;  obs1.encounter = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Encounter/&apos; + %encounter.id) &quot;reference&quot;;
      section -&gt; obs1.status = &apos;final&apos; &quot;STatusobse&quot;;
      section.code -&gt; obs1.code;
      act1.statusCode as s then {
        s.code as cos -&gt; obs1.status = translate(cos, &apos;#OBSstatus&apos;, &apos;code&apos;) &quot;codeS&quot;;
      } &quot;status&quot;;
      section -&gt;  bundle.entry as e4,  e4.request = create(&apos;BackboneElement&apos;) as request,  request.method = &apos;POST&apos;,  e4.resource = create(&apos;List&apos;) as list1,  list1.id = uuid() as uuid4,  e4.fullUrl = append(&apos;https://example/List/&apos;, uuid4),  request.url = &apos;List&apos;,  obs1.focus = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/List/&apos; + %list1.id) then {
        section -&gt;  list1.subject = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Patient/&apos; + %patient.id) &quot;reference&quot;;
        section -&gt; list1.status = &apos;current&apos; &quot;listatus&quot;;
        section -&gt; list1.mode = &apos;working&apos; &quot;lstmod&quot;;
        section -&gt;  list1.encounter = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Encounter/&apos; + %encounter.id) &quot;reference&quot;;
        src -&gt; list1.entry as entryList1 then {
          act1 -&gt;  bundle.entry as e5,  e5.request = create(&apos;BackboneElement&apos;) as request,  request.method = &apos;POST&apos;,  e5.resource = create(&apos;AllergyIntolerance&apos;) as allergy,  allergy.id = uuid() as uuid5,  e5.fullUrl = append(&apos;https://example/AllergyIntolerance/&apos;, uuid5),  request.url = &apos;AllergyIntolerance&apos;,  entryList1.item = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/AllergyIntolerance/&apos; + %allergy.id) then allergyFunction(act1, allergy, patient, encounter) &quot;allergy&quot;;
        } &quot;item&quot;;
      } &quot;list&quot;;
    } &quot;allergyAct&quot;;
    section where (code.code = &apos;55111-9&apos;) -&gt;  bundle.entry as e3,  e3.request = create(&apos;BackboneElement&apos;) as request,  request.method = &apos;POST&apos;,  e3.resource = create(&apos;Observation&apos;) as obs2,  obs2.id = uuid() as uuid3,  e3.fullUrl = append(&apos;https://example/Observation/&apos;, uuid3),  request.url = &apos;Observation&apos;,  dReport.result = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Observation/&apos; + %obs2.id) then Observation(act1, patient, encounter, obs2, bundle) &quot;observation&quot;;
  };
  src.observation as entryobs then {
    section where (code.code = &apos;11329-0&apos;) -&gt;  bundle.entry as e6,  e6.request = create(&apos;BackboneElement&apos;) as request,  request.method = &apos;POST&apos;,  e6.resource = create(&apos;Observation&apos;) as obs6,  obs6.id = uuid() as uuid6,  e6.fullUrl = append(&apos;https://example/Observation/&apos;, uuid6),  request.url = &apos;Observation&apos;,  dReport.result = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Observation/&apos; + %obs6.id) then {
      section -&gt;  obs6.subject = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Patient/&apos; + %patient.id) &quot;reference&quot;;
      section -&gt;  obs6.encounter = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Encounter/&apos; + %encounter.id) &quot;reference&quot;;
      section -&gt; obs6.status = &apos;final&apos; &quot;tatusobse&quot;;
      section.code -&gt; obs6.code;
      entryobs -&gt;  bundle.entry as e7,  e7.request = create(&apos;BackboneElement&apos;) as request,  request.method = &apos;POST&apos;,  e7.resource = create(&apos;Condition&apos;) as condition1,  condition1.id = uuid() as uuid7,  e7.fullUrl = append(&apos;https://example/Condition/&apos;, uuid7),  request.url = &apos;Condition&apos;,  obs6.focus = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Condition/&apos; + %condition1.id) then ConditionFunction(entryobs, condition1, patient, encounter, bundle) &quot;condition&quot;;
    } &quot;observationstclinica&quot;;
    section where (code.code = &apos;55114-3&apos;) -&gt;  bundle.entry as e9,  e9.request = create(&apos;BackboneElement&apos;) as request,  request.method = &apos;POST&apos;,  e9.resource = create(&apos;Observation&apos;) as obs9,  obs9.id = uuid() as uuid9,  e9.fullUrl = append(&apos;https://example/Observation/&apos;, uuid9),  request.url = &apos;Observation&apos;,  dReport.result = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Observation/&apos; + %obs9.id) then Observation(entryobs, patient, encounter, obs9, bundle) &quot;precedenti esami&quot;;
    section where (code.code = &apos;55109-3&apos;) -&gt;  bundle.entry as e8,  e8.request = create(&apos;BackboneElement&apos;) as request,  request.method = &apos;POST&apos;,  e8.resource = create(&apos;Observation&apos;) as obs8,  obs8.id = uuid() as uuid8,  e8.fullUrl = append(&apos;https://example/Observation/&apos;, uuid8),  request.url = &apos;Observation&apos;,  dReport.result = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Observation/&apos; + %obs8.id) then Observation(entryobs, patient, encounter, obs8, bundle) &quot;complicanze&quot;;
    section where (code.code = &apos;18785-6&apos;) -&gt;  bundle.entry as e14,  e14.request = create(&apos;BackboneElement&apos;) as request,  request.method = &apos;POST&apos;,  e14.resource = create(&apos;Observation&apos;) as obs14,  obs14.id = uuid() as uuid14,  e14.fullUrl = append(&apos;https://example/Observation/&apos;, uuid14),  request.url = &apos;Observation&apos;,  dReport.result = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Observation/&apos; + %obs14.id) then Observation(entryobs, patient, encounter, obs14, bundle) &quot;quesitoDiagnostico&quot;;
  } &quot;entryObs&quot;;
  src.organizer as organizer then {
    src -&gt;  bundle.entry as e10,  e10.request = create(&apos;BackboneElement&apos;) as request,  request.method = &apos;POST&apos;,  e10.resource = create(&apos;Observation&apos;) as obs10,  obs10.id = uuid() as uuid10,  e10.fullUrl = append(&apos;https://example/Observation/&apos;, uuid10),  request.url = &apos;Observation&apos;,  dReport.result = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Observation/&apos; + %obs10.id) then {
      section -&gt;  obs10.subject = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Patient/&apos; + %patient.id) &quot;reference&quot;;
      section -&gt;  obs10.encounter = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Encounter/&apos; + %encounter.id) &quot;reference&quot;;
      section -&gt; obs10.status = &apos;final&apos; &quot;tatusobse&quot;;
      section.code -&gt; obs10.code &quot;codeObs&quot;;
      section -&gt;  bundle.entry as e11,  e11.request = create(&apos;BackboneElement&apos;) as request,  request.method = &apos;POST&apos;,  e11.resource = create(&apos;List&apos;) as list11,  list11.id = uuid() as uuid11,  e11.fullUrl = append(&apos;https://example/List/&apos;, uuid11),  request.url = &apos;List&apos;,  obs10.focus = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/List/&apos; + %list11.id) then {
        section -&gt;  list11.subject = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Patient/&apos; + %patient.id) &quot;reference&quot;;
        section -&gt; list11.status = &apos;current&apos; &quot;liststat&quot;;
        section -&gt; list11.mode = &apos;working&apos; &quot;listmd&quot;;
        section -&gt;  list11.encounter = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Encounter/&apos; + %encounter.id) &quot;reference&quot;;
        organizer -&gt; list11.entry as entryList2 then {
          organizer -&gt;  bundle.entry as e12,  e12.request = create(&apos;BackboneElement&apos;) as request,  request.method = &apos;POST&apos;,  e12.resource = create(&apos;FamilyMemberHistory&apos;) as familyMember,  familyMember.id = uuid() as uuid12,  e12.fullUrl = append(&apos;https://example/FamilyMemberHistory/&apos;, uuid12),  request.url = &apos;FamilyMemberHistory&apos;,  entryList2.item = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/FamilyMemberHistory/&apos; + %familyMember.id) then FamilyMemberFunction(organizer, familyMember, patient) &quot;family&quot;;
        } &quot;org&quot;;
      } &quot;List&quot;;
    } &quot;entryOrganizer&quot;;
  };
  section where section.entry.exists().not() then {
    section where (code.code = &apos;55110-1&apos;).not() then {
      section.text as text -&gt;  bundle.entry as e13,  e13.request = create(&apos;BackboneElement&apos;) as request,  request.method = &apos;POST&apos;,  e13.resource = create(&apos;Observation&apos;) as obs13,  obs13.id = uuid() as uuid13,  e13.fullUrl = append(&apos;https://example/Observation/&apos;, uuid13),  request.url = &apos;Observation&apos;,  dReport.result = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Observation/&apos; + %obs13.id) then {
        section -&gt;  obs13.subject = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Patient/&apos; + %patient.id) &quot;reference&quot;;
        section -&gt;  obs13.encounter = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Encounter/&apos; + %encounter.id) &quot;reference&quot;;
        section -&gt; obs13.status = &apos;preliminary&apos; &quot;obsst&quot;;
        section.code -&gt; obs13.code &quot;obscde&quot;;
        section -&gt; obs13.status = &apos;final&apos; &quot;statusS&quot;;
        text -&gt; obs13.note as note then {
          text as t -&gt; note.text = create(&apos;string&apos;) as textNote then EDstring(t, textNote) &quot;note&quot;;
        } &quot;narrative&quot;;
      } &quot;txtsec&quot;;
    } &quot;NonConclusion&quot;;
    section where (code.code = &apos;55110-1&apos;) then {
      section.text as t -&gt; dReport.conclusion = create(&apos;string&apos;) as textConclusion then EDstring(t, textConclusion) &quot;conc&quot;;
    } &quot;conclusion&quot;;
  } &quot;whereCond&quot;;
}

group Observation(source cda : observation, target patient : Patient, target encounter : Encounter, target ob : Observation, target bundle : Bundle) {
  cda -&gt;  ob.subject = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Patient/&apos; + %patient.id) &quot;reference&quot;;
  cda -&gt;  ob.encounter = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Encounter/&apos; + %encounter.id) &quot;reference&quot;;
  cda.code -&gt; ob.code;
  cda -&gt; ob.status = &apos;final&apos; &quot;Stats&quot;;
  // value datatype
  cda.value : ST as st -&gt;  ob.value = create(&apos;string&apos;),  ob.value = (st.dataString);
  cda.value : BL as boolean -&gt; ob.value = (boolean.value) &quot;boolean&quot;;
  cda.value : INT as int -&gt; ob.value = (int.value);
  cda.value : CE as val then {
    val -&gt; ob.value = create(&apos;CodeableConcept&apos;) as ce then {
      val.originalText as originalText then {
        originalText.reference as reference -&gt; ce.text = (reference.value);
      };
      val -&gt; ce.coding as coding then {
        val.code as code -&gt; coding.code = cast(code, &apos;string&apos;);
        val.codeSystem as system -&gt; coding.system = translate(system, &apos;http://hl7.org/fhir/ConceptMap/special-oid2uri&apos;, &apos;uri&apos;);
        val.displayName as display -&gt; coding.display = cast(display, &apos;string&apos;);
      } &quot;code&quot;;
      val.translation as translation -&gt; ce.coding as coding then {
        translation.code as code -&gt; coding.code = cast(code, &apos;string&apos;);
        translation.codeSystem as system -&gt; coding.system = translate(system, &apos;http://hl7.org/fhir/ConceptMap/special-oid2uri&apos;, &apos;uri&apos;);
        translation.displayName as display -&gt; coding.display = cast(display, &apos;string&apos;);
        translation.qualifier as qualifier then {
          qualifier.value as value -&gt; ce.coding as coding then {
            value.code as code -&gt; coding.code = cast(code, &apos;string&apos;);
            value.codeSystem as system -&gt; coding.system = translate(system, &apos;http://hl7.org/fhir/ConceptMap/special-oid2uri&apos;, &apos;uri&apos;);
            value.displayName as display -&gt; coding.display = cast(display, &apos;string&apos;);
          };
        };
      };
    } &quot;coding&quot;;
  } &quot;val&quot;;
  cda.value : CD as val then {
    val -&gt; ob.value = create(&apos;CodeableConcept&apos;) as ce then {
      val.originalText as originalText then {
        originalText.reference as reference -&gt; ce.text = (reference.value);
      };
      val -&gt; ce.coding as coding then {
        val.code as code -&gt; coding.code = cast(code, &apos;string&apos;);
        val.codeSystem as system -&gt; coding.system = translate(system, &apos;http://hl7.org/fhir/ConceptMap/special-oid2uri&apos;, &apos;uri&apos;);
        val.displayName as display -&gt; coding.display = cast(display, &apos;string&apos;);
      } &quot;code&quot;;
      val.translation as translation -&gt; ce.coding as coding then {
        translation.code as code -&gt; coding.code = cast(code, &apos;string&apos;);
        translation.codeSystem as system -&gt; coding.system = translate(system, &apos;http://hl7.org/fhir/ConceptMap/special-oid2uri&apos;, &apos;uri&apos;);
        translation.displayName as display -&gt; coding.display = cast(display, &apos;string&apos;);
        translation.qualifier as qualifier then {
          qualifier.value as value -&gt; ce.coding as coding then {
            value.code as code -&gt; coding.code = cast(code, &apos;string&apos;);
            value.codeSystem as system -&gt; coding.system = translate(system, &apos;http://hl7.org/fhir/ConceptMap/special-oid2uri&apos;, &apos;uri&apos;);
            value.displayName as display -&gt; coding.display = cast(display, &apos;string&apos;);
          };
        };
      };
    } &quot;coding&quot;;
  } &quot;val&quot;;
  cda.value : PQ as val then {
    val -&gt; ob.value = create(&apos;Quantity&apos;) as quantity then {
      val.value as value -&gt; quantity.value = value;
      val.unit as unit -&gt; quantity.unit = unit;
    } &quot;quantity&quot;;
  } &quot;valueQuantity&quot;;
  cda.effectiveTime as effectiveTime where (value.exists()) -&gt; ob.effective = create(&apos;dateTime&apos;) as value then TSDateTime(effectiveTime, value) &quot;value1&quot;;
  cda.effectiveTime as effectiveTime where (low.exists()) -&gt; ob.effective = create(&apos;Period&apos;) as value then IVLTSPeriod(effectiveTime, value) &quot;valuePeriod&quot;;
  cda.text as text -&gt; ob.note as note then {
    text.reference as reference -&gt; note.text = (reference.value) &quot;text&quot;;
  } &quot;note&quot;;
  cda.statusCode as s then {
    s.code as cos -&gt; ob.status = translate(cos, &apos;#OBSstatus&apos;, &apos;code&apos;) &quot;codeS&quot;;
  } &quot;status&quot;;
}

group ImagingStudy(source src : act, source section : section, target tgt : ImagingStudy, target patient : patient, target encounter : encounter) {
  src.id -&gt; tgt.identifier;
  src -&gt;  tgt.subject = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Patient/&apos; + %patient.id) &quot;reference&quot;;
  src -&gt;  tgt.encounter = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Encounter/&apos; + %encounter.id) &quot;reference&quot;;
  src -&gt; tgt.status = &apos;available&apos; &quot;status&quot;;
  src.entryRelationship as entryRelationship then {
    entryRelationship.act as act -&gt; tgt.series as series then {
      act.id as id -&gt; series.uid = (id.root);
      section.code as code -&gt; series.modality = create(&apos;Coding&apos;) as coding then {
        code.code as code1 -&gt; coding.code = cast(code1, &apos;string&apos;);
        code.codeSystem as system -&gt; coding.system = translate(system, &apos;http://hl7.org/fhir/ConceptMap/special-oid2uri&apos;, &apos;uri&apos;);
        code.displayName as display -&gt; coding.display = cast(display, &apos;string&apos;);
      } &quot;modality&quot;;
      act.entryRelationship as entryRelationship2 then {
        entryRelationship2.observation as obs -&gt; series.instance as instance then {
          obs.id as id -&gt; instance.uid = (id.root) &quot;root&quot;;
          obs.code as code1 -&gt; instance.sopClass = create(&apos;Coding&apos;) as coding then {
            code1.code as code -&gt; coding.code = cast(code, &apos;string&apos;);
            code1.codeSystem as system -&gt; coding.system = translate(system, &apos;http://hl7.org/fhir/ConceptMap/special-oid2uri&apos;, &apos;uri&apos;);
            code1.displayName as display -&gt; coding.display = cast(display, &apos;string&apos;);
          } &quot;sopClass&quot;;
        } &quot;idRoot&quot;;
      } &quot;instance&quot;;
    } &quot;series&quot;;
  };
}

group ConditionFunction(source src : cdaElement, target tgt : Condition, target patient : patient, target encounter : encounter, target bundle : Bundle) {
  src.code -&gt; tgt.category;
  src -&gt;  tgt.subject = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Patient/&apos; + %patient.id) &quot;reference&quot;;
  src -&gt;  tgt.encounter = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Encounter/&apos; + %encounter.id) &quot;reference&quot;;
  src.statusCode as stscode -&gt; tgt.verificationStatus as verifstatus then {
    stscode as codeS -&gt; verifstatus.coding = create(&apos;Coding&apos;) as coding then {
      codeS.code -&gt; coding.code = &apos;confirmed&apos;;
      codeS -&gt; coding.system = &apos;http://terminology.hl7.org/CodeSystem/condition-ver-status&apos; &quot;system&quot;;
      codeS -&gt; coding.display = cast(&apos;Confirmed&apos;, &apos;string&apos;) &quot;display&quot;;
    } &quot;coding&quot;;
  } &quot;verifstatus&quot;;
  src.effectiveTime as effectiveTime -&gt; tgt.onset = create(&apos;Period&apos;) as value then IVLTSPeriod(effectiveTime, value) &quot;valuePeriod&quot;;
  src.value -&gt; tgt.code;
  src.entryRelationship as entryRelationship then {
    entryRelationship.observation as obsentry then {
      obsentry.code where code = &apos;89261-2&apos; then {
        obsentry -&gt;  tgt.evidence as evidence,  bundle.entry as e1,  e1.request = create(&apos;BackboneElement&apos;) as request,  request.method = &apos;POST&apos;,  e1.resource = create(&apos;Observation&apos;) as obsy,  obsy.id = uuid() as uuid1,  e1.fullUrl = append(&apos;https://example/Observation/&apos;, uuid1),  request.url = &apos;Observation&apos;,  evidence.detail = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Observation/&apos; + %obsy.id) then Observation(obsentry, patient, encounter, obsy, bundle) &quot;observation&quot;;
      } &quot;observation&quot;;
      obsentry.code where code = &apos;33999-4&apos; then {
        obsentry.value as value -&gt; tgt.clinicalStatus as clinicalstatus then {
          value as val -&gt; clinicalstatus.coding = create(&apos;Coding&apos;) as coding then {
            val where (code = &apos;LA9041-0&apos;) -&gt; coding.code = &apos;resolved&apos; &quot;code&quot;;
            val where (code = &apos;LA18632-2&apos;) -&gt; coding.code = &apos;inactive&apos; &quot;code&quot;;
            val where (code = &apos;LA16666-2&apos;) -&gt; coding.code = &apos;active&apos; &quot;code&quot;;
            val -&gt; coding.system = &apos;http://terminology.hl7.org/CodeSystem/condition-clinical&apos; &quot;system&quot;;
            val.displayName as display -&gt; coding.display = cast(display, &apos;string&apos;) &quot;display&quot;;
          } &quot;coding&quot;;
          obsentry.text as text then {
            text.reference as reference -&gt; clinicalstatus.text = (reference.value) &quot;text&quot;;
          };
        } &quot;clinicalstatus&quot;;
      } &quot;clinicalStatus2&quot;;
    } &quot;EntryRelObsevation&quot;;
  } &quot;entryR&quot;;
}

group allergyFunction(source src : cdaElement, target tgt : AllergyIntolerance, target patient : patient, target encounter : encounter) {
  src -&gt;  tgt.patient = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Patient/&apos; + %patient.id) &quot;reference&quot;;
  src -&gt;  tgt.encounter = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Encounter/&apos; + %encounter.id) &quot;reference&quot;;
  src.entryRelationship as entryRelationship1 then {
    entryRelationship1.observation as observation1 then {
      observation1.effectiveTime as effectiveTime -&gt; tgt.onset = create(&apos;Period&apos;) as value then IVLTSPeriod(effectiveTime, value) &quot;valuePeriod&quot;;
      observation1.value as code then {
        code.code as code1 -&gt; tgt.type = translate(code1, &apos;#AllergyTypeMap&apos;, &apos;code&apos;) &quot;type&quot;;
        code.code as code1 -&gt; tgt.category = translate(code1, &apos;#AllergyCategoryMap&apos;, &apos;code&apos;) &quot;category&quot;;
      } &quot;code&quot;;
      observation1.participant as participant -&gt; tgt.reaction as reaction then {
        observation1.entryRelationship as entryRelationship2 where (typeCode = &apos;MFST&apos;) then {
          entryRelationship2.observation as observation2 then {
            observation2.value -&gt; reaction.manifestation &quot;manifestation&quot;;
            observation2.effectiveTime as effectiveTime then {
              effectiveTime.low as low -&gt; reaction.onset = create(&apos;dateTime&apos;) as value then TSDateTime(low, value) &quot;valuePeriodLow&quot;;
            } &quot;low&quot;;
          } &quot;observ2&quot;;
        } &quot;entryR2&quot;;
        participant.participantRole as participantRole then {
          participantRole.playingEntity as playingEntity then {
            playingEntity.code -&gt; reaction.substance &quot;reaction&quot;;
          };
        };
      };
      observation1.entryRelationship as entryRelationship2 where (typeCode = &apos;MFST&apos;) then {
        entryRelationship2.observation as observation2 where observation1.participant.exists().not() -&gt; tgt.reaction as reaction then {
          observation2.value -&gt; reaction.manifestation &quot;manifestation&quot;;
          observation2.effectiveTime as effectiveTime then {
            effectiveTime.low as low -&gt; reaction.onset = create(&apos;dateTime&apos;) as value then TSDateTime(low, value) &quot;valuePeriodLow&quot;;
          } &quot;low&quot;;
        } &quot;observ2&quot;;
      } &quot;entryR2&quot;;
      observation1.entryRelationship as entryRelationship3 where (typeCode = &apos;SUBJ&apos;) then {
        entryRelationship3.observation as observation3 then {
          // criticality
          observation3.value as value then {
            value.code as c -&gt; tgt.criticality = translate(c, &apos;#CricalityMap&apos;, &apos;code&apos;) &quot;value&quot;;
          } &quot;criticality&quot;;
        } &quot;observ3&quot;;
        entryRelationship3.act as act -&gt; tgt.note as note then {
          act.text as text then {
            text.reference as reference -&gt; note.text = (reference.value);
          } &quot;note&quot;;
        };
      } &quot;entryR3&quot;;
      observation1.entryRelationship as entryRelationship4 where (typeCode = &apos;REFR&apos;) then {
        entryRelationship4.observation as observation4 then {
          // observation4.value -&gt; tgt.clinicalStatus;
          observation4.value as value -&gt; tgt.clinicalStatus as clinicalStatus then {
            value as valu -&gt; clinicalStatus.coding = create(&apos;Coding&apos;) as coding then {
              valu where (code = &apos;LA9041-0&apos;) -&gt; coding.code = &apos;resolved&apos; &quot;code&quot;;
              valu where (code = &apos;LA18632-2&apos;) -&gt; coding.code = &apos;inactive&apos; &quot;code&quot;;
              valu where (code = &apos;LA16666-2&apos;) -&gt; coding.code = &apos;active&apos; &quot;code&quot;;
              valu -&gt; coding.system = &apos;http://terminology.hl7.org/CodeSystem/allergyintolerance-clinical&apos; &quot;system&quot;;
              valu.displayName as display -&gt; coding.display = cast(display, &apos;string&apos;) &quot;display&quot;;
            } &quot;coding&quot;;
          } &quot;clinicalStatus&quot;;
        } &quot;observ4&quot;;
      } &quot;entryR4&quot;;
    };
  } &quot;entryrelationship&quot;;
}

group FamilyMemberFunction(source src : organizer, target tgt : familyMember, target patient : patient) {
  src -&gt;  tgt.patient = create(&apos;Reference&apos;) as reference,  reference.reference = (&apos;https://example/Patient/&apos; + %patient.id) &quot;patReference&quot;;
  src.statusCode -&gt; tgt.status;
  src.effectiveTime as effectiveTime -&gt; tgt.date = create(&apos;date&apos;) as value then TSDate(effectiveTime, value) &quot;date&quot;;
  src.subject as subject then {
    subject.relatedSubject as relatedSubject then {
      relatedSubject.code -&gt; tgt.relationship &quot;relationship code&quot;;
      relatedSubject.subject as subject -&gt; tgt.sex as sex then {
        subject.administrativeGenderCode as administrativeGenderCode -&gt; sex.coding as coding then {
          administrativeGenderCode.code as sexCode -&gt; coding.code = translate(sexCode, &apos;#cm-v3-administrative-gender&apos;, &apos;code&apos;) &quot;gender&quot;;
          administrativeGenderCode.system -&gt; coding.system = &apos;http://hl7.org/fhir/administrative-gender&apos;;
        } &quot;coding&quot;;
      };
    } &quot;relatedSub&quot;;
  } &quot;relationship&quot;;
  src.component as component -&gt; tgt.condition as condition then {
    component.observation as observation then {
      observation.code -&gt; condition.code;
      observation.text as text -&gt; tgt.note as note then {
        text.reference as reference -&gt; note.text = (reference.value) &quot;value&quot;;
      } &quot;reference&quot;;
      observation.statusCode -&gt; tgt.status;
      observation.effectiveTime as effectiveTime -&gt; condition.onset = create(&apos;Period&apos;) as value then IVLTSPeriod(effectiveTime, value) &quot;valuePeriod&quot;;
      observation.value -&gt; condition.outcome &quot;codeable&quot;;
      observation.entryRelationship as entryR then {
        entryR.observation as obs then {
          obs where (code.code = &apos;35267-4&apos;) then {
            obs.value as value -&gt; condition.onset = create(&apos;Age&apos;) as Age then {
              value.value as valueAge -&gt; Age.value = valueAge &quot;age&quot;;
              value.unit as unit -&gt; Age.code = unit;
              value.unit as unit -&gt; Age.unit = unit;
              value -&gt; Age.system = &apos;http://unitsofmeasure.org&apos; &quot;system&quot;;
            };
          } &quot;insorgenza&quot;;
          obs where (code.code = &apos;39016-1&apos;) then {
            obs.value as value -&gt; tgt.deceased = create(&apos;Age&apos;) as Age then {
              value.value as valueAge -&gt; Age.value = valueAge &quot;age&quot;;
              value.unit as unit -&gt; Age.code = unit;
              value.unit as unit -&gt; Age.unit = unit;
              value -&gt; Age.system = &apos;http://unitsofmeasure.org&apos; &quot;system&quot;;
            };
          } &quot;death&quot;;
        } &quot;obser&quot;;
      } &quot;EntryRel&quot;;
    };
  };
}

</pre>
      </div>
   </text>
   <contained>
      <ConceptMap xmlns="http://hl7.org/fhir">
         <id value="OBSstatus"/>
         <status value="draft"/>
         <group>
            <source value="http://terminology.hl7.org/ValueSet/v3-statusCode"/>
            <target value="http://hl7.org/fhir/status.html"/>
            <element>
               <code value="completed"/>
               <target>
                  <code value="final"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
            <element>
               <code value="active"/>
               <target>
                  <code value="registered"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
            <element>
               <code value="aborted"/>
               <target>
                  <code value="cancelled"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
            <element>
               <code value="suspended"/>
               <target>
                  <code value="partial"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
         </group>
      </ConceptMap>
   </contained>
   <contained>
      <ConceptMap xmlns="http://hl7.org/fhir">
         <id value="cm-v3-administrative-gender"/>
         <status value="draft"/>
         <group>
            <source value="http://terminology.hl7.org/ValueSet/v3-AdministrativeGender"/>
            <target value="http://hl7.org/fhir/ValueSet/administrative-gender"/>
            <element>
               <code value="M"/>
               <target>
                  <code value="male"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
            <element>
               <code value="F"/>
               <target>
                  <code value="female"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
         </group>
      </ConceptMap>
   </contained>
   <contained>
      <ConceptMap xmlns="http://hl7.org/fhir">
         <id value="AllergyTypeMap"/>
         <status value="draft"/>
         <group>
            <source value="http://terminology.hl7.org/ValueSet/v3-type"/>
            <target value="http://hl7.org/fhir/Allergy-type.html"/>
            <element>
               <code value="OINT"/>
               <target>
                  <code value="intolerance"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
            <element>
               <code value="ALG"/>
               <target>
                  <code value="allergy"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
            <element>
               <code value="DALG"/>
               <target>
                  <code value="allergy"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
            <element>
               <code value="EALG"/>
               <target>
                  <code value="allergy"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
            <element>
               <code value="FALG"/>
               <target>
                  <code value="allergy"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
            <element>
               <code value="NAINT"/>
               <target>
                  <code value="intolerance"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
            <element>
               <code value="FNAINT"/>
               <target>
                  <code value="intolerance"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
            <element>
               <code value="DNAINT"/>
               <target>
                  <code value="intolerance"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
            <element>
               <code value="ENAINT"/>
               <target>
                  <code value="intolerance"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
            <element>
               <code value="FINT"/>
               <target>
                  <code value="intolerance"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
            <element>
               <code value="DINT"/>
               <target>
                  <code value="intolerance"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
            <element>
               <code value="EINT"/>
               <target>
                  <code value="intolerance"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
         </group>
      </ConceptMap>
   </contained>
   <contained>
      <ConceptMap xmlns="http://hl7.org/fhir">
         <id value="AllergyCategoryMap"/>
         <status value="draft"/>
         <group>
            <source value="http://terminology.hl7.org/ValueSet/v3-type"/>
            <target value="http://hl7.org/fhir/Allergy-type.html"/>
            <element>
               <code value="DALG"/>
               <target>
                  <code value="medication"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
            <element>
               <code value="EALG"/>
               <target>
                  <code value="enviroment"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
            <element>
               <code value="FALG"/>
               <target>
                  <code value="food"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
            <element>
               <code value="FNAINT"/>
               <target>
                  <code value="intolerance"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
            <element>
               <code value="DNAINT"/>
               <target>
                  <code value="medication"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
            <element>
               <code value="ENAINT"/>
               <target>
                  <code value="enviroment"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
            <element>
               <code value="FINT"/>
               <target>
                  <code value="food"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
            <element>
               <code value="DINT"/>
               <target>
                  <code value="medication"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
            <element>
               <code value="EINT"/>
               <target>
                  <code value="enviroment"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
         </group>
      </ConceptMap>
   </contained>
   <contained>
      <ConceptMap xmlns="http://hl7.org/fhir">
         <id value="CricalityMap"/>
         <status value="draft"/>
         <group>
            <source value="http://terminology.hl7.org/CodeSystem/v3-ObservationValue"/>
            <target value="http://hl7.org/fhir/allergy-intolerance-criticality"/>
            <element>
               <code value="M"/>
               <target>
                  <code value="low"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
            <element>
               <code value="H"/>
               <target>
                  <code value="high"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
            <element>
               <code value="L"/>
               <target>
                  <code value="low"/>
                  <equivalence value="equivalent"/>
               </target>
            </element>
         </group>
      </ConceptMap>
   </contained>
   <url value="http://hl7.it/fhir/cda2fhir/StructureMap/cda2fhirRadReport"/>
   <name value="cda2fhirRadReport"/>
   <structure>
      <url value="http://hl7.org/fhir/cda/StructureDefinition/ClinicalDocument"/>
      <mode value="source"/>
      <alias value="ClinicalDocument"/>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/cda/StructureDefinition/AssignedAuthor"/>
      <mode value="queried"/>
      <alias value="AssignedAuthor"/>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/cda/StructureDefinition/AssignedEntity"/>
      <mode value="queried"/>
      <alias value="AssignedEntity"/>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/cda/StructureDefinition/AssociatedEntity"/>
      <mode value="queried"/>
      <alias value="AssociatedEntity"/>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/cda/StructureDefinition/CustodianOrganization"/>
      <mode value="queried"/>
      <alias value="CustodianOrganization"/>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/cda/StructureDefinition/OrganizationPartOf"/>
      <mode value="queried"/>
      <alias value="OrganizationPartOf"/>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/cda/StructureDefinition/Organization"/>
      <mode value="queried"/>
      <alias value="rapresentedOrganization"/>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/cda/StructureDefinition/Section"/>
      <mode value="queried"/>
      <alias value="Section"/>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/cda/StructureDefinition/PatientRole"/>
      <mode value="queried"/>
      <alias value="PatientRole"/>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/cda/StructureDefinition/AD"/>
      <mode value="source"/>
      <alias value="AD"/>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/StructureDefinition/Bundle"/>
      <mode value="target"/>
      <alias value="Bundle"/>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/StructureDefinition/Composition"/>
      <mode value="produced"/>
      <alias value="Composition"/>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/StructureDefinition/Patient"/>
      <mode value="produced"/>
      <alias value="Patient"/>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/StructureDefinition/Encounter"/>
      <mode value="produced"/>
      <alias value="Encounter"/>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/StructureDefinition/Person"/>
      <mode value="produced"/>
      <alias value="Patient"/>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/StructureDefinition/List"/>
      <mode value="produced"/>
      <alias value="List"/>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/StructureDefinition/Practitioner"/>
      <mode value="produced"/>
      <alias value="Practitioner"/>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/StructureDefinition/Organization"/>
      <mode value="produced"/>
      <alias value="Organization"/>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/cda/StructureDefinition/Act"/>
      <mode value="produced"/>
      <alias value="Act"/>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/cda/StructureDefinition/IVL-PQ"/>
      <mode value="source"/>
      <alias value="IVL_PQ"/>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/cda/StructureDefinition/PQ"/>
      <mode value="source"/>
      <alias value="PQ"/>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/StructureDefinition/SimpleQuantity"/>
      <mode value="target"/>
      <alias value="SimpleQuantity"/>
   </structure>
   <import value="http://hl7.it/fhir/cda2fhir/StructureMap/cda2fhirDataTypes"/>
   <import value="http://hl7.it/fhir/cda2fhir/StructureMap/cda2fhirHeader"/>
   <group>
      <name value="CdaToBundle"/>
      <typeMode value="none"/>
      <input>
         <name value="cda"/>
         <type value="ClinicalDocument"/>
         <mode value="source"/>
      </input>
      <input>
         <name value="bundle"/>
         <type value="Bundle"/>
         <mode value="target"/>
      </input>
      <rule>
         <name value="ClinicalDocumentToBody"/>
         <source>
            <context value="cda"/>
         </source>
         <target>
            <context value="bundle"/>
            <contextType value="variable"/>
            <element value="entry"/>
            <variable value="e"/>
         </target>
         <target>
            <context value="e"/>
            <contextType value="variable"/>
            <element value="request"/>
            <variable value="request"/>
            <transform value="create"/>
            <parameter>
               <valueString value="BackboneElement"/>
            </parameter>
         </target>
         <target>
            <context value="request"/>
            <contextType value="variable"/>
            <element value="method"/>
            <transform value="copy"/>
            <parameter>
               <valueString value="POST"/>
            </parameter>
         </target>
         <target>
            <context value="e"/>
            <contextType value="variable"/>
            <element value="resource"/>
            <variable value="composition"/>
            <transform value="create"/>
            <parameter>
               <valueString value="Composition"/>
            </parameter>
         </target>
         <target>
            <context value="composition"/>
            <contextType value="variable"/>
            <element value="id"/>
            <variable value="uuid1"/>
            <transform value="uuid"/>
         </target>
         <target>
            <context value="e"/>
            <contextType value="variable"/>
            <element value="fullUrl"/>
            <transform value="append"/>
            <parameter>
               <valueString value="https://example/Composition/"/>
            </parameter>
            <parameter>
               <valueId value="uuid1"/>
            </parameter>
         </target>
         <target>
            <context value="request"/>
            <contextType value="variable"/>
            <element value="url"/>
            <transform value="copy"/>
            <parameter>
               <valueString value="Composition"/>
            </parameter>
         </target>
         <target>
            <context value="bundle"/>
            <contextType value="variable"/>
            <element value="entry"/>
            <variable value="e2"/>
         </target>
         <target>
            <context value="e2"/>
            <contextType value="variable"/>
            <element value="request"/>
            <variable value="requestPAT"/>
            <transform value="create"/>
            <parameter>
               <valueString value="BackboneElement"/>
            </parameter>
         </target>
         <target>
            <context value="requestPAT"/>
            <contextType value="variable"/>
            <element value="method"/>
            <transform value="copy"/>
            <parameter>
               <valueString value="PUT"/>
            </parameter>
         </target>
         <target>
            <context value="e2"/>
            <contextType value="variable"/>
            <element value="resource"/>
            <variable value="patient"/>
            <transform value="create"/>
            <parameter>
               <valueString value="Patient"/>
            </parameter>
         </target>
         <target>
            <context value="patient"/>
            <contextType value="variable"/>
            <element value="id"/>
            <variable value="uuid2"/>
            <transform value="uuid"/>
         </target>
         <target>
            <context value="e2"/>
            <contextType value="variable"/>
            <element value="fullUrl"/>
            <transform value="append"/>
            <parameter>
               <valueString value="https://example/Patient/"/>
            </parameter>
            <parameter>
               <valueId value="uuid2"/>
            </parameter>
         </target>
         <target>
            <context value="bundle"/>
            <contextType value="variable"/>
            <element value="entry"/>
            <variable value="e3"/>
         </target>
         <target>
            <context value="e3"/>
            <contextType value="variable"/>
            <element value="request"/>
            <variable value="request"/>
            <transform value="create"/>
            <parameter>
               <valueString value="BackboneElement"/>
            </parameter>
         </target>
         <target>
            <context value="request"/>
            <contextType value="variable"/>
            <element value="method"/>
            <transform value="copy"/>
            <parameter>
               <valueString value="POST"/>
            </parameter>
         </target>
         <target>
            <context value="e3"/>
            <contextType value="variable"/>
            <element value="resource"/>
            <variable value="encounter"/>
            <transform value="create"/>
            <parameter>
               <valueString value="Encounter"/>
            </parameter>
         </target>
         <target>
            <context value="encounter"/>
            <contextType value="variable"/>
            <element value="id"/>
            <variable value="uuid3"/>
            <transform value="uuid"/>
         </target>
         <target>
            <context value="e3"/>
            <contextType value="variable"/>
            <element value="fullUrl"/>
            <transform value="append"/>
            <parameter>
               <valueString value="https://example/Encounter/"/>
            </parameter>
            <parameter>
               <valueId value="uuid3"/>
            </parameter>
         </target>
         <target>
            <context value="request"/>
            <contextType value="variable"/>
            <element value="url"/>
            <transform value="copy"/>
            <parameter>
               <valueString value="Encounter"/>
            </parameter>
         </target>
         <target>
            <context value="bundle"/>
            <contextType value="variable"/>
            <element value="entry"/>
            <variable value="e4"/>
         </target>
         <target>
            <context value="e4"/>
            <contextType value="variable"/>
            <element value="request"/>
            <variable value="request"/>
            <transform value="create"/>
            <parameter>
               <valueString value="BackboneElement"/>
            </parameter>
         </target>
         <target>
            <context value="request"/>
            <contextType value="variable"/>
            <element value="method"/>
            <transform value="copy"/>
            <parameter>
               <valueString value="POST"/>
            </parameter>
         </target>
         <target>
            <context value="e4"/>
            <contextType value="variable"/>
            <element value="resource"/>
            <variable value="DocumentReference"/>
            <transform value="create"/>
            <parameter>
               <valueString value="DocumentReference"/>
            </parameter>
         </target>
         <target>
            <context value="DocumentReference"/>
            <contextType value="variable"/>
            <element value="id"/>
            <variable value="uuid4"/>
            <transform value="uuid"/>
         </target>
         <target>
            <context value="e4"/>
            <contextType value="variable"/>
            <element value="fullUrl"/>
            <transform value="append"/>
            <parameter>
               <valueString value="https://example/DocumentReference/"/>
            </parameter>
            <parameter>
               <valueId value="uuid4"/>
            </parameter>
         </target>
         <target>
            <context value="request"/>
            <contextType value="variable"/>
            <element value="url"/>
            <transform value="copy"/>
            <parameter>
               <valueString value="DocumentReference"/>
            </parameter>
         </target>
         <rule>
            <name value="cdatobundle"/>
            <source>
               <context value="cda"/>
            </source>
            <dependent>
               <name value="ClinicalDocumentToBundle"/>
               <variable value="cda">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="patient">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="composition">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="encounter">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="bundle">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="DocumentReference">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
            </dependent>
         </rule>
         <rule>
            <name value="patient"/>
            <source>
               <context value="cda"/>
               <element value="recordTarget"/>
               <variable value="recordTarget"/>
            </source>
            <rule>
               <name value="recPat"/>
               <source>
                  <context value="recordTarget"/>
                  <element value="patientRole"/>
                  <variable value="patient"/>
               </source>
               <rule>
                  <name value="idfr"/>
                  <source>
                     <context value="patient"/>
                     <element value="id"/>
                     <variable value="id"/>
                  </source>
                  <target>
                     <context value="patient"/>
                     <contextType value="variable"/>
                     <element value="identifier"/>
                     <variable value="identifier"/>
                  </target>
                  <rule>
                     <name value="root1"/>
                     <source>
                        <context value="id"/>
                        <element value="root"/>
                        <variable value="r"/>
                     </source>
                     <target>
                        <context value="identifier"/>
                        <contextType value="variable"/>
                        <element value="system"/>
                        <transform value="translate"/>
                        <parameter>
                           <valueId value="r"/>
                        </parameter>
                        <parameter>
                           <valueString value="http://hl7.org/fhir/ConceptMap/special-oid2uri"/>
                        </parameter>
                        <parameter>
                           <valueString value="uri"/>
                        </parameter>
                     </target>
                  </rule>
                  <rule>
                     <name value="value"/>
                     <source>
                        <context value="id"/>
                        <element value="extension"/>
                        <variable value="ext1"/>
                     </source>
                     <target>
                        <context value="identifier"/>
                        <contextType value="variable"/>
                        <element value="value"/>
                        <transform value="copy"/>
                        <parameter>
                           <valueId value="ext1"/>
                        </parameter>
                     </target>
                  </rule>
                  <rule>
                     <name value="assigningAuthorityName"/>
                     <source>
                        <context value="id"/>
                        <element value="assigningAuthorityName"/>
                        <variable value="s"/>
                     </source>
                     <target>
                        <context value="identifier"/>
                        <contextType value="variable"/>
                        <element value="assigner"/>
                        <variable value="a"/>
                     </target>
                     <target>
                        <context value="a"/>
                        <contextType value="variable"/>
                        <element value="display"/>
                        <transform value="copy"/>
                        <parameter>
                           <valueId value="s"/>
                        </parameter>
                     </target>
                  </rule>
               </rule>
               <rule>
                  <name value="record"/>
                  <source>
                     <context value="patient"/>
                     <element value="id"/>
                     <variable value="id"/>
                     <condition value="(root = '2.16.840.1.113883.2.9.4.3.2') or (root = '2.16.840.1.113883.2.9.4.3.7') or (root = '2.16.840.1.113883.2.9.4.3.3') or (root = '2.16.840.1.113883.2.9.4.3.17') or (root = '2.16.840.1.113883.2.9.4.3.15')"/>
                  </source>
                  <rule>
                     <name value="UUID"/>
                     <source>
                        <context value="id"/>
                        <element value="extension"/>
                        <variable value="ext"/>
                     </source>
                     <target>
                        <context value="requestPAT"/>
                        <contextType value="variable"/>
                        <element value="url"/>
                        <transform value="append"/>
                        <parameter>
                           <valueString value="Patient?identifier="/>
                        </parameter>
                        <parameter>
                           <valueId value="ext"/>
                        </parameter>
                     </target>
                  </rule>
               </rule>
            </rule>
         </rule>
      </rule>
   </group>
   <group>
      <name value="ClinicalDocumentToBundle"/>
      <typeMode value="none"/>
      <input>
         <name value="cda"/>
         <type value="ClinicalDocument"/>
         <mode value="source"/>
      </input>
      <input>
         <name value="patient"/>
         <type value="Patient"/>
         <mode value="target"/>
      </input>
      <input>
         <name value="composition"/>
         <type value="Composition"/>
         <mode value="target"/>
      </input>
      <input>
         <name value="encounter"/>
         <type value="Encounter"/>
         <mode value="target"/>
      </input>
      <input>
         <name value="bundle"/>
         <type value="Bundle"/>
         <mode value="target"/>
      </input>
      <input>
         <name value="DocumentReference"/>
         <type value="DocumentReference"/>
         <mode value="target"/>
      </input>
      <rule>
         <name value="id"/>
         <source>
            <context value="cda"/>
         </source>
         <target>
            <context value="bundle"/>
            <contextType value="variable"/>
            <element value="id"/>
            <transform value="uuid"/>
         </target>
      </rule>
      <rule>
         <name value="identifier"/>
         <source>
            <context value="cda"/>
            <element value="id"/>
            <variable value="vvv"/>
         </source>
         <target>
            <context value="bundle"/>
            <contextType value="variable"/>
            <element value="identifier"/>
            <variable value="vvv"/>
            <transform value="create"/>
         </target>
      </rule>
      <rule>
         <name value="type"/>
         <source>
            <context value="cda"/>
         </source>
         <target>
            <context value="bundle"/>
            <contextType value="variable"/>
            <element value="type"/>
            <transform value="copy"/>
            <parameter>
               <valueString value="transaction"/>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="effectiveTime"/>
         <source>
            <context value="cda"/>
            <element value="effectiveTime"/>
            <variable value="vvv"/>
         </source>
         <target>
            <context value="bundle"/>
            <contextType value="variable"/>
            <element value="timestamp"/>
            <variable value="vvv"/>
            <transform value="create"/>
         </target>
      </rule>
      <rule>
         <name value="composition"/>
         <source>
            <context value="cda"/>
         </source>
         <dependent>
            <name value="ClinicalDocumentComposition"/>
            <variable value="cda">
               <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                  <valueUrl value="id"/>
               </extension>
            </variable>
            <variable value="composition">
               <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                  <valueUrl value="id"/>
               </extension>
            </variable>
            <variable value="patient">
               <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                  <valueUrl value="id"/>
               </extension>
            </variable>
            <variable value="encounter">
               <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                  <valueUrl value="id"/>
               </extension>
            </variable>
            <variable value="bundle">
               <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                  <valueUrl value="id"/>
               </extension>
            </variable>
            <variable value="DocumentReference">
               <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                  <valueUrl value="id"/>
               </extension>
            </variable>
         </dependent>
      </rule>
      <rule>
         <name value="diagnostic"/>
         <source>
            <context value="cda"/>
         </source>
         <target>
            <context value="bundle"/>
            <contextType value="variable"/>
            <element value="entry"/>
            <variable value="e"/>
         </target>
         <target>
            <context value="e"/>
            <contextType value="variable"/>
            <element value="request"/>
            <variable value="request"/>
            <transform value="create"/>
            <parameter>
               <valueString value="BackboneElement"/>
            </parameter>
         </target>
         <target>
            <context value="request"/>
            <contextType value="variable"/>
            <element value="method"/>
            <transform value="copy"/>
            <parameter>
               <valueString value="POST"/>
            </parameter>
         </target>
         <target>
            <context value="e"/>
            <contextType value="variable"/>
            <element value="resource"/>
            <variable value="diagnosticReport"/>
            <transform value="create"/>
            <parameter>
               <valueString value="DiagnosticReport"/>
            </parameter>
         </target>
         <target>
            <context value="diagnosticReport"/>
            <contextType value="variable"/>
            <element value="id"/>
            <variable value="uuid1"/>
            <transform value="uuid"/>
         </target>
         <target>
            <context value="e"/>
            <contextType value="variable"/>
            <element value="fullUrl"/>
            <transform value="append"/>
            <parameter>
               <valueString value="https://example/DiagnosticReport/"/>
            </parameter>
            <parameter>
               <valueId value="uuid1"/>
            </parameter>
         </target>
         <target>
            <context value="request"/>
            <contextType value="variable"/>
            <element value="url"/>
            <transform value="copy"/>
            <parameter>
               <valueString value="DiagnosticReport"/>
            </parameter>
         </target>
         <rule>
            <name value="diagnosticCode"/>
            <source>
               <context value="cda"/>
               <element value="code"/>
               <variable value="vvv"/>
            </source>
            <target>
               <context value="diagnosticReport"/>
               <contextType value="variable"/>
               <element value="code"/>
               <variable value="vvv"/>
               <transform value="create"/>
            </target>
         </rule>
         <rule>
            <name value="stats"/>
            <source>
               <context value="cda"/>
            </source>
            <target>
               <context value="diagnosticReport"/>
               <contextType value="variable"/>
               <element value="status"/>
               <transform value="copy"/>
               <parameter>
                  <valueString value="registered"/>
               </parameter>
            </target>
         </rule>
         <rule>
            <name value="component"/>
            <source>
               <context value="cda"/>
               <element value="component"/>
               <variable value="component"/>
            </source>
            <rule>
               <name value="body"/>
               <source>
                  <context value="component"/>
                  <element value="structuredBody"/>
                  <variable value="body"/>
               </source>
               <rule>
                  <name value="component"/>
                  <source>
                     <context value="body"/>
                     <element value="component"/>
                     <variable value="component"/>
                  </source>
                  <rule>
                     <name value="section"/>
                     <source>
                        <context value="component"/>
                        <element value="section"/>
                        <variable value="srcSection"/>
                     </source>
                     <rule>
                        <name value="code"/>
                        <source>
                           <context value="srcSection"/>
                           <element value="code"/>
                        </source>
                        <target>
                           <context value="composition"/>
                           <contextType value="variable"/>
                           <element value="section"/>
                           <variable value="tgtSection"/>
                        </target>
                        <dependent>
                           <name value="ClinicalDocumentSection"/>
                           <variable value="cda">
                              <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                                 <valueUrl value="id"/>
                              </extension>
                           </variable>
                           <variable value="srcSection">
                              <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                                 <valueUrl value="id"/>
                              </extension>
                           </variable>
                           <variable value="patient">
                              <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                                 <valueUrl value="id"/>
                              </extension>
                           </variable>
                           <variable value="tgtSection">
                              <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                                 <valueUrl value="id"/>
                              </extension>
                           </variable>
                           <variable value="bundle">
                              <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                                 <valueUrl value="id"/>
                              </extension>
                           </variable>
                           <variable value="encounter">
                              <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                                 <valueUrl value="id"/>
                              </extension>
                           </variable>
                           <variable value="diagnosticReport">
                              <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                                 <valueUrl value="id"/>
                              </extension>
                           </variable>
                        </dependent>
                     </rule>
                  </rule>
               </rule>
            </rule>
         </rule>
      </rule>
   </group>
   <group>
      <name value="ClinicalDocumentSection"/>
      <typeMode value="none"/>
      <input>
         <name value="cda"/>
         <type value="ClinicalDocument"/>
         <mode value="source"/>
      </input>
      <input>
         <name value="src"/>
         <type value="Section"/>
         <mode value="source"/>
      </input>
      <input>
         <name value="patient"/>
         <type value="Patient"/>
         <mode value="target"/>
      </input>
      <input>
         <name value="tgt"/>
         <mode value="target"/>
      </input>
      <input>
         <name value="bundle"/>
         <type value="Bundle"/>
         <mode value="target"/>
      </input>
      <input>
         <name value="enc"/>
         <type value="Encounter"/>
         <mode value="target"/>
      </input>
      <input>
         <name value="dReport"/>
         <type value="DiagnosticReport"/>
         <mode value="target"/>
      </input>
      <rule>
         <name value="title"/>
         <source>
            <context value="src"/>
            <element value="title"/>
            <variable value="t"/>
         </source>
         <target>
            <context value="tgt"/>
            <contextType value="variable"/>
            <element value="title"/>
            <transform value="evaluate"/>
            <parameter>
               <valueString value="t.dataString"/>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="code"/>
         <source>
            <context value="src"/>
            <element value="code"/>
            <variable value="vvv"/>
         </source>
         <target>
            <context value="tgt"/>
            <contextType value="variable"/>
            <element value="code"/>
            <variable value="vvv"/>
            <transform value="create"/>
         </target>
      </rule>
      <rule>
         <name value="reference"/>
         <source>
            <context value="src"/>
         </source>
         <target>
            <context value="tgt"/>
            <contextType value="variable"/>
            <element value="entry"/>
            <variable value="reference"/>
            <transform value="create"/>
            <parameter>
               <valueString value="Reference"/>
            </parameter>
         </target>
         <target>
            <context value="reference"/>
            <contextType value="variable"/>
            <element value="reference"/>
            <transform value="evaluate"/>
            <parameter>
               <valueString value="'https://example/DiagnosticReport/' + %dReport.id"/>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="entry"/>
         <source>
            <context value="src"/>
            <element value="entry"/>
            <variable value="entry"/>
         </source>
         <rule>
            <name value="cdaText"/>
            <source>
               <context value="src"/>
               <element value="text"/>
               <variable value="cdaText"/>
            </source>
            <target>
               <context value="tgt"/>
               <contextType value="variable"/>
               <element value="text"/>
               <variable value="fhirText"/>
            </target>
            <rule>
               <name value="narrativeStatus"/>
               <source>
                  <context value="cdaText"/>
               </source>
               <target>
                  <context value="fhirText"/>
                  <contextType value="variable"/>
                  <element value="status"/>
                  <transform value="copy"/>
                  <parameter>
                     <valueString value="generated"/>
                  </parameter>
               </target>
            </rule>
            <rule>
               <name value="narrativeText"/>
               <source>
                  <context value="cdaText"/>
                  <variable value="t"/>
               </source>
               <target>
                  <context value="fhirText"/>
                  <contextType value="variable"/>
                  <element value="div"/>
                  <transform value="copy"/>
                  <parameter>
                     <valueId value="t"/>
                  </parameter>
               </target>
            </rule>
         </rule>
         <rule>
            <name value="dreport"/>
            <source>
               <context value="entry"/>
            </source>
            <dependent>
               <name value="DiagnosticReportFunction"/>
               <variable value="src">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="entry">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="dReport">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="bundle">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="enc">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="patient">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
            </dependent>
         </rule>
      </rule>
      <rule>
         <name value="narrative"/>
         <source>
            <context value="src"/>
            <condition value="src.entry.exists().not()"/>
         </source>
         <dependent>
            <name value="DiagnosticReportFunction"/>
            <variable value="src">
               <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                  <valueUrl value="id"/>
               </extension>
            </variable>
            <variable value="cda">
               <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                  <valueUrl value="id"/>
               </extension>
            </variable>
            <variable value="dReport">
               <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                  <valueUrl value="id"/>
               </extension>
            </variable>
            <variable value="bundle">
               <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                  <valueUrl value="id"/>
               </extension>
            </variable>
            <variable value="enc">
               <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                  <valueUrl value="id"/>
               </extension>
            </variable>
            <variable value="patient">
               <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                  <valueUrl value="id"/>
               </extension>
            </variable>
         </dependent>
      </rule>
      <rule>
         <name value="component"/>
         <source>
            <context value="src"/>
            <element value="component"/>
            <variable value="component"/>
         </source>
         <rule>
            <name value="section"/>
            <source>
               <context value="component"/>
               <element value="section"/>
               <variable value="sec"/>
            </source>
            <target>
               <context value="tgt"/>
               <contextType value="variable"/>
               <element value="section"/>
               <variable value="tgtSection"/>
            </target>
            <dependent>
               <name value="ClinicalDocumentSection"/>
               <variable value="cda">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="sec">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="patient">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="tgtSection">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="bundle">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="enc">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="dReport">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
            </dependent>
         </rule>
      </rule>
   </group>
   <group>
      <name value="DiagnosticReportFunction"/>
      <typeMode value="none"/>
      <input>
         <name value="section"/>
         <type value="section"/>
         <mode value="source"/>
      </input>
      <input>
         <name value="src"/>
         <type value="entry"/>
         <mode value="source"/>
      </input>
      <input>
         <name value="dReport"/>
         <type value="DiagnosticReport"/>
         <mode value="target"/>
      </input>
      <input>
         <name value="bundle"/>
         <type value="Bundle"/>
         <mode value="target"/>
      </input>
      <input>
         <name value="encounter"/>
         <type value="Encounter"/>
         <mode value="target"/>
      </input>
      <input>
         <name value="patient"/>
         <type value="Patient"/>
         <mode value="target"/>
      </input>
      <rule>
         <name value="act"/>
         <source>
            <context value="src"/>
            <element value="act"/>
            <variable value="act1"/>
         </source>
         <rule>
            <name value="imagingStudy"/>
            <source>
               <context value="section"/>
               <condition value="(code.code = '121181')"/>
            </source>
            <target>
               <context value="bundle"/>
               <contextType value="variable"/>
               <element value="entry"/>
               <variable value="e1"/>
            </target>
            <target>
               <context value="e1"/>
               <contextType value="variable"/>
               <element value="request"/>
               <variable value="request"/>
               <transform value="create"/>
               <parameter>
                  <valueString value="BackboneElement"/>
               </parameter>
            </target>
            <target>
               <context value="request"/>
               <contextType value="variable"/>
               <element value="method"/>
               <transform value="copy"/>
               <parameter>
                  <valueString value="POST"/>
               </parameter>
            </target>
            <target>
               <context value="e1"/>
               <contextType value="variable"/>
               <element value="resource"/>
               <variable value="imageS"/>
               <transform value="create"/>
               <parameter>
                  <valueString value="ImagingStudy"/>
               </parameter>
            </target>
            <target>
               <context value="imageS"/>
               <contextType value="variable"/>
               <element value="id"/>
               <variable value="uuid1"/>
               <transform value="uuid"/>
            </target>
            <target>
               <context value="e1"/>
               <contextType value="variable"/>
               <element value="fullUrl"/>
               <transform value="append"/>
               <parameter>
                  <valueString value="https://example/ImagingStudy/"/>
               </parameter>
               <parameter>
                  <valueId value="uuid1"/>
               </parameter>
            </target>
            <target>
               <context value="request"/>
               <contextType value="variable"/>
               <element value="url"/>
               <transform value="copy"/>
               <parameter>
                  <valueString value="ImagingStudy"/>
               </parameter>
            </target>
            <target>
               <context value="dReport"/>
               <contextType value="variable"/>
               <element value="imagingStudy"/>
               <variable value="reference"/>
               <transform value="create"/>
               <parameter>
                  <valueString value="Reference"/>
               </parameter>
            </target>
            <target>
               <context value="reference"/>
               <contextType value="variable"/>
               <element value="reference"/>
               <transform value="evaluate"/>
               <parameter>
                  <valueString value="'https://example/ImagingStudy/' + %imageS.id"/>
               </parameter>
            </target>
            <dependent>
               <name value="ImagingStudy"/>
               <variable value="act1">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="section">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="imageS">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="patient">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="encounter">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
            </dependent>
         </rule>
         <rule>
            <name value="allergyAct"/>
            <source>
               <context value="section"/>
               <condition value="(code.code = '48765-2')"/>
            </source>
            <target>
               <context value="bundle"/>
               <contextType value="variable"/>
               <element value="entry"/>
               <variable value="e2"/>
            </target>
            <target>
               <context value="e2"/>
               <contextType value="variable"/>
               <element value="request"/>
               <variable value="request"/>
               <transform value="create"/>
               <parameter>
                  <valueString value="BackboneElement"/>
               </parameter>
            </target>
            <target>
               <context value="request"/>
               <contextType value="variable"/>
               <element value="method"/>
               <transform value="copy"/>
               <parameter>
                  <valueString value="POST"/>
               </parameter>
            </target>
            <target>
               <context value="e2"/>
               <contextType value="variable"/>
               <element value="resource"/>
               <variable value="obs1"/>
               <transform value="create"/>
               <parameter>
                  <valueString value="Observation"/>
               </parameter>
            </target>
            <target>
               <context value="obs1"/>
               <contextType value="variable"/>
               <element value="id"/>
               <variable value="uuid2"/>
               <transform value="uuid"/>
            </target>
            <target>
               <context value="e2"/>
               <contextType value="variable"/>
               <element value="fullUrl"/>
               <transform value="append"/>
               <parameter>
                  <valueString value="https://example/Observation/"/>
               </parameter>
               <parameter>
                  <valueId value="uuid2"/>
               </parameter>
            </target>
            <target>
               <context value="request"/>
               <contextType value="variable"/>
               <element value="url"/>
               <transform value="copy"/>
               <parameter>
                  <valueString value="Observation"/>
               </parameter>
            </target>
            <target>
               <context value="dReport"/>
               <contextType value="variable"/>
               <element value="result"/>
               <variable value="reference"/>
               <transform value="create"/>
               <parameter>
                  <valueString value="Reference"/>
               </parameter>
            </target>
            <target>
               <context value="reference"/>
               <contextType value="variable"/>
               <element value="reference"/>
               <transform value="evaluate"/>
               <parameter>
                  <valueString value="'https://example/Observation/' + %obs1.id"/>
               </parameter>
            </target>
            <rule>
               <name value="reference"/>
               <source>
                  <context value="section"/>
               </source>
               <target>
                  <context value="obs1"/>
                  <contextType value="variable"/>
                  <element value="subject"/>
                  <variable value="reference"/>
                  <transform value="create"/>
                  <parameter>
                     <valueString value="Reference"/>
                  </parameter>
               </target>
               <target>
                  <context value="reference"/>
                  <contextType value="variable"/>
                  <element value="reference"/>
                  <transform value="evaluate"/>
                  <parameter>
                     <valueString value="'https://example/Patient/' + %patient.id"/>
                  </parameter>
               </target>
            </rule>
            <rule>
               <name value="reference"/>
               <source>
                  <context value="section"/>
               </source>
               <target>
                  <context value="obs1"/>
                  <contextType value="variable"/>
                  <element value="encounter"/>
                  <variable value="reference"/>
                  <transform value="create"/>
                  <parameter>
                     <valueString value="Reference"/>
                  </parameter>
               </target>
               <target>
                  <context value="reference"/>
                  <contextType value="variable"/>
                  <element value="reference"/>
                  <transform value="evaluate"/>
                  <parameter>
                     <valueString value="'https://example/Encounter/' + %encounter.id"/>
                  </parameter>
               </target>
            </rule>
            <rule>
               <name value="STatusobse"/>
               <source>
                  <context value="section"/>
               </source>
               <target>
                  <context value="obs1"/>
                  <contextType value="variable"/>
                  <element value="status"/>
                  <transform value="copy"/>
                  <parameter>
                     <valueString value="final"/>
                  </parameter>
               </target>
            </rule>
            <rule>
               <name value="code"/>
               <source>
                  <context value="section"/>
                  <element value="code"/>
                  <variable value="vvv"/>
               </source>
               <target>
                  <context value="obs1"/>
                  <contextType value="variable"/>
                  <element value="code"/>
                  <variable value="vvv"/>
                  <transform value="create"/>
               </target>
            </rule>
            <rule>
               <name value="status"/>
               <source>
                  <context value="act1"/>
                  <element value="statusCode"/>
                  <variable value="s"/>
               </source>
               <rule>
                  <name value="codeS"/>
                  <source>
                     <context value="s"/>
                     <element value="code"/>
                     <variable value="cos"/>
                  </source>
                  <target>
                     <context value="obs1"/>
                     <contextType value="variable"/>
                     <element value="status"/>
                     <transform value="translate"/>
                     <parameter>
                        <valueId value="cos"/>
                     </parameter>
                     <parameter>
                        <valueString value="#OBSstatus"/>
                     </parameter>
                     <parameter>
                        <valueString value="code"/>
                     </parameter>
                  </target>
               </rule>
            </rule>
            <rule>
               <name value="list"/>
               <source>
                  <context value="section"/>
               </source>
               <target>
                  <context value="bundle"/>
                  <contextType value="variable"/>
                  <element value="entry"/>
                  <variable value="e4"/>
               </target>
               <target>
                  <context value="e4"/>
                  <contextType value="variable"/>
                  <element value="request"/>
                  <variable value="request"/>
                  <transform value="create"/>
                  <parameter>
                     <valueString value="BackboneElement"/>
                  </parameter>
               </target>
               <target>
                  <context value="request"/>
                  <contextType value="variable"/>
                  <element value="method"/>
                  <transform value="copy"/>
                  <parameter>
                     <valueString value="POST"/>
                  </parameter>
               </target>
               <target>
                  <context value="e4"/>
                  <contextType value="variable"/>
                  <element value="resource"/>
                  <variable value="list1"/>
                  <transform value="create"/>
                  <parameter>
                     <valueString value="List"/>
                  </parameter>
               </target>
               <target>
                  <context value="list1"/>
                  <contextType value="variable"/>
                  <element value="id"/>
                  <variable value="uuid4"/>
                  <transform value="uuid"/>
               </target>
               <target>
                  <context value="e4"/>
                  <contextType value="variable"/>
                  <element value="fullUrl"/>
                  <transform value="append"/>
                  <parameter>
                     <valueString value="https://example/List/"/>
                  </parameter>
                  <parameter>
                     <valueId value="uuid4"/>
                  </parameter>
               </target>
               <target>
                  <context value="request"/>
                  <contextType value="variable"/>
                  <element value="url"/>
                  <transform value="copy"/>
                  <parameter>
                     <valueString value="List"/>
                  </parameter>
               </target>
               <target>
                  <context value="obs1"/>
                  <contextType value="variable"/>
                  <element value="focus"/>
                  <variable value="reference"/>
                  <transform value="create"/>
                  <parameter>
                     <valueString value="Reference"/>
                  </parameter>
               </target>
               <target>
                  <context value="reference"/>
                  <contextType value="variable"/>
                  <element value="reference"/>
                  <transform value="evaluate"/>
                  <parameter>
                     <valueString value="'https://example/List/' + %list1.id"/>
                  </parameter>
               </target>
               <rule>
                  <name value="reference"/>
                  <source>
                     <context value="section"/>
                  </source>
                  <target>
                     <context value="list1"/>
                     <contextType value="variable"/>
                     <element value="subject"/>
                     <variable value="reference"/>
                     <transform value="create"/>
                     <parameter>
                        <valueString value="Reference"/>
                     </parameter>
                  </target>
                  <target>
                     <context value="reference"/>
                     <contextType value="variable"/>
                     <element value="reference"/>
                     <transform value="evaluate"/>
                     <parameter>
                        <valueString value="'https://example/Patient/' + %patient.id"/>
                     </parameter>
                  </target>
               </rule>
               <rule>
                  <name value="listatus"/>
                  <source>
                     <context value="section"/>
                  </source>
                  <target>
                     <context value="list1"/>
                     <contextType value="variable"/>
                     <element value="status"/>
                     <transform value="copy"/>
                     <parameter>
                        <valueString value="current"/>
                     </parameter>
                  </target>
               </rule>
               <rule>
                  <name value="lstmod"/>
                  <source>
                     <context value="section"/>
                  </source>
                  <target>
                     <context value="list1"/>
                     <contextType value="variable"/>
                     <element value="mode"/>
                     <transform value="copy"/>
                     <parameter>
                        <valueString value="working"/>
                     </parameter>
                  </target>
               </rule>
               <rule>
                  <name value="reference"/>
                  <source>
                     <context value="section"/>
                  </source>
                  <target>
                     <context value="list1"/>
                     <contextType value="variable"/>
                     <element value="encounter"/>
                     <variable value="reference"/>
                     <transform value="create"/>
                     <parameter>
                        <valueString value="Reference"/>
                     </parameter>
                  </target>
                  <target>
                     <context value="reference"/>
                     <contextType value="variable"/>
                     <element value="reference"/>
                     <transform value="evaluate"/>
                     <parameter>
                        <valueString value="'https://example/Encounter/' + %encounter.id"/>
                     </parameter>
                  </target>
               </rule>
               <rule>
                  <name value="item"/>
                  <source>
                     <context value="src"/>
                  </source>
                  <target>
                     <context value="list1"/>
                     <contextType value="variable"/>
                     <element value="entry"/>
                     <variable value="entryList1"/>
                  </target>
                  <rule>
                     <name value="allergy"/>
                     <source>
                        <context value="act1"/>
                     </source>
                     <target>
                        <context value="bundle"/>
                        <contextType value="variable"/>
                        <element value="entry"/>
                        <variable value="e5"/>
                     </target>
                     <target>
                        <context value="e5"/>
                        <contextType value="variable"/>
                        <element value="request"/>
                        <variable value="request"/>
                        <transform value="create"/>
                        <parameter>
                           <valueString value="BackboneElement"/>
                        </parameter>
                     </target>
                     <target>
                        <context value="request"/>
                        <contextType value="variable"/>
                        <element value="method"/>
                        <transform value="copy"/>
                        <parameter>
                           <valueString value="POST"/>
                        </parameter>
                     </target>
                     <target>
                        <context value="e5"/>
                        <contextType value="variable"/>
                        <element value="resource"/>
                        <variable value="allergy"/>
                        <transform value="create"/>
                        <parameter>
                           <valueString value="AllergyIntolerance"/>
                        </parameter>
                     </target>
                     <target>
                        <context value="allergy"/>
                        <contextType value="variable"/>
                        <element value="id"/>
                        <variable value="uuid5"/>
                        <transform value="uuid"/>
                     </target>
                     <target>
                        <context value="e5"/>
                        <contextType value="variable"/>
                        <element value="fullUrl"/>
                        <transform value="append"/>
                        <parameter>
                           <valueString value="https://example/AllergyIntolerance/"/>
                        </parameter>
                        <parameter>
                           <valueId value="uuid5"/>
                        </parameter>
                     </target>
                     <target>
                        <context value="request"/>
                        <contextType value="variable"/>
                        <element value="url"/>
                        <transform value="copy"/>
                        <parameter>
                           <valueString value="AllergyIntolerance"/>
                        </parameter>
                     </target>
                     <target>
                        <context value="entryList1"/>
                        <contextType value="variable"/>
                        <element value="item"/>
                        <variable value="reference"/>
                        <transform value="create"/>
                        <parameter>
                           <valueString value="Reference"/>
                        </parameter>
                     </target>
                     <target>
                        <context value="reference"/>
                        <contextType value="variable"/>
                        <element value="reference"/>
                        <transform value="evaluate"/>
                        <parameter>
                           <valueString value="'https://example/AllergyIntolerance/' + %allergy.id"/>
                        </parameter>
                     </target>
                     <dependent>
                        <name value="allergyFunction"/>
                        <variable value="act1">
                           <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                              <valueUrl value="id"/>
                           </extension>
                        </variable>
                        <variable value="allergy">
                           <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                              <valueUrl value="id"/>
                           </extension>
                        </variable>
                        <variable value="patient">
                           <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                              <valueUrl value="id"/>
                           </extension>
                        </variable>
                        <variable value="encounter">
                           <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                              <valueUrl value="id"/>
                           </extension>
                        </variable>
                     </dependent>
                  </rule>
               </rule>
            </rule>
         </rule>
         <rule>
            <name value="observation"/>
            <source>
               <context value="section"/>
               <condition value="(code.code = '55111-9')"/>
            </source>
            <target>
               <context value="bundle"/>
               <contextType value="variable"/>
               <element value="entry"/>
               <variable value="e3"/>
            </target>
            <target>
               <context value="e3"/>
               <contextType value="variable"/>
               <element value="request"/>
               <variable value="request"/>
               <transform value="create"/>
               <parameter>
                  <valueString value="BackboneElement"/>
               </parameter>
            </target>
            <target>
               <context value="request"/>
               <contextType value="variable"/>
               <element value="method"/>
               <transform value="copy"/>
               <parameter>
                  <valueString value="POST"/>
               </parameter>
            </target>
            <target>
               <context value="e3"/>
               <contextType value="variable"/>
               <element value="resource"/>
               <variable value="obs2"/>
               <transform value="create"/>
               <parameter>
                  <valueString value="Observation"/>
               </parameter>
            </target>
            <target>
               <context value="obs2"/>
               <contextType value="variable"/>
               <element value="id"/>
               <variable value="uuid3"/>
               <transform value="uuid"/>
            </target>
            <target>
               <context value="e3"/>
               <contextType value="variable"/>
               <element value="fullUrl"/>
               <transform value="append"/>
               <parameter>
                  <valueString value="https://example/Observation/"/>
               </parameter>
               <parameter>
                  <valueId value="uuid3"/>
               </parameter>
            </target>
            <target>
               <context value="request"/>
               <contextType value="variable"/>
               <element value="url"/>
               <transform value="copy"/>
               <parameter>
                  <valueString value="Observation"/>
               </parameter>
            </target>
            <target>
               <context value="dReport"/>
               <contextType value="variable"/>
               <element value="result"/>
               <variable value="reference"/>
               <transform value="create"/>
               <parameter>
                  <valueString value="Reference"/>
               </parameter>
            </target>
            <target>
               <context value="reference"/>
               <contextType value="variable"/>
               <element value="reference"/>
               <transform value="evaluate"/>
               <parameter>
                  <valueString value="'https://example/Observation/' + %obs2.id"/>
               </parameter>
            </target>
            <dependent>
               <name value="Observation"/>
               <variable value="act1">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="patient">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="encounter">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="obs2">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="bundle">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
            </dependent>
         </rule>
      </rule>
      <rule>
         <name value="entryObs"/>
         <source>
            <context value="src"/>
            <element value="observation"/>
            <variable value="entryobs"/>
         </source>
         <rule>
            <name value="observationstclinica"/>
            <source>
               <context value="section"/>
               <condition value="(code.code = '11329-0')"/>
            </source>
            <target>
               <context value="bundle"/>
               <contextType value="variable"/>
               <element value="entry"/>
               <variable value="e6"/>
            </target>
            <target>
               <context value="e6"/>
               <contextType value="variable"/>
               <element value="request"/>
               <variable value="request"/>
               <transform value="create"/>
               <parameter>
                  <valueString value="BackboneElement"/>
               </parameter>
            </target>
            <target>
               <context value="request"/>
               <contextType value="variable"/>
               <element value="method"/>
               <transform value="copy"/>
               <parameter>
                  <valueString value="POST"/>
               </parameter>
            </target>
            <target>
               <context value="e6"/>
               <contextType value="variable"/>
               <element value="resource"/>
               <variable value="obs6"/>
               <transform value="create"/>
               <parameter>
                  <valueString value="Observation"/>
               </parameter>
            </target>
            <target>
               <context value="obs6"/>
               <contextType value="variable"/>
               <element value="id"/>
               <variable value="uuid6"/>
               <transform value="uuid"/>
            </target>
            <target>
               <context value="e6"/>
               <contextType value="variable"/>
               <element value="fullUrl"/>
               <transform value="append"/>
               <parameter>
                  <valueString value="https://example/Observation/"/>
               </parameter>
               <parameter>
                  <valueId value="uuid6"/>
               </parameter>
            </target>
            <target>
               <context value="request"/>
               <contextType value="variable"/>
               <element value="url"/>
               <transform value="copy"/>
               <parameter>
                  <valueString value="Observation"/>
               </parameter>
            </target>
            <target>
               <context value="dReport"/>
               <contextType value="variable"/>
               <element value="result"/>
               <variable value="reference"/>
               <transform value="create"/>
               <parameter>
                  <valueString value="Reference"/>
               </parameter>
            </target>
            <target>
               <context value="reference"/>
               <contextType value="variable"/>
               <element value="reference"/>
               <transform value="evaluate"/>
               <parameter>
                  <valueString value="'https://example/Observation/' + %obs6.id"/>
               </parameter>
            </target>
            <rule>
               <name value="reference"/>
               <source>
                  <context value="section"/>
               </source>
               <target>
                  <context value="obs6"/>
                  <contextType value="variable"/>
                  <element value="subject"/>
                  <variable value="reference"/>
                  <transform value="create"/>
                  <parameter>
                     <valueString value="Reference"/>
                  </parameter>
               </target>
               <target>
                  <context value="reference"/>
                  <contextType value="variable"/>
                  <element value="reference"/>
                  <transform value="evaluate"/>
                  <parameter>
                     <valueString value="'https://example/Patient/' + %patient.id"/>
                  </parameter>
               </target>
            </rule>
            <rule>
               <name value="reference"/>
               <source>
                  <context value="section"/>
               </source>
               <target>
                  <context value="obs6"/>
                  <contextType value="variable"/>
                  <element value="encounter"/>
                  <variable value="reference"/>
                  <transform value="create"/>
                  <parameter>
                     <valueString value="Reference"/>
                  </parameter>
               </target>
               <target>
                  <context value="reference"/>
                  <contextType value="variable"/>
                  <element value="reference"/>
                  <transform value="evaluate"/>
                  <parameter>
                     <valueString value="'https://example/Encounter/' + %encounter.id"/>
                  </parameter>
               </target>
            </rule>
            <rule>
               <name value="tatusobse"/>
               <source>
                  <context value="section"/>
               </source>
               <target>
                  <context value="obs6"/>
                  <contextType value="variable"/>
                  <element value="status"/>
                  <transform value="copy"/>
                  <parameter>
                     <valueString value="final"/>
                  </parameter>
               </target>
            </rule>
            <rule>
               <name value="code"/>
               <source>
                  <context value="section"/>
                  <element value="code"/>
                  <variable value="vvv"/>
               </source>
               <target>
                  <context value="obs6"/>
                  <contextType value="variable"/>
                  <element value="code"/>
                  <variable value="vvv"/>
                  <transform value="create"/>
               </target>
            </rule>
            <rule>
               <name value="condition"/>
               <source>
                  <context value="entryobs"/>
               </source>
               <target>
                  <context value="bundle"/>
                  <contextType value="variable"/>
                  <element value="entry"/>
                  <variable value="e7"/>
               </target>
               <target>
                  <context value="e7"/>
                  <contextType value="variable"/>
                  <element value="request"/>
                  <variable value="request"/>
                  <transform value="create"/>
                  <parameter>
                     <valueString value="BackboneElement"/>
                  </parameter>
               </target>
               <target>
                  <context value="request"/>
                  <contextType value="variable"/>
                  <element value="method"/>
                  <transform value="copy"/>
                  <parameter>
                     <valueString value="POST"/>
                  </parameter>
               </target>
               <target>
                  <context value="e7"/>
                  <contextType value="variable"/>
                  <element value="resource"/>
                  <variable value="condition1"/>
                  <transform value="create"/>
                  <parameter>
                     <valueString value="Condition"/>
                  </parameter>
               </target>
               <target>
                  <context value="condition1"/>
                  <contextType value="variable"/>
                  <element value="id"/>
                  <variable value="uuid7"/>
                  <transform value="uuid"/>
               </target>
               <target>
                  <context value="e7"/>
                  <contextType value="variable"/>
                  <element value="fullUrl"/>
                  <transform value="append"/>
                  <parameter>
                     <valueString value="https://example/Condition/"/>
                  </parameter>
                  <parameter>
                     <valueId value="uuid7"/>
                  </parameter>
               </target>
               <target>
                  <context value="request"/>
                  <contextType value="variable"/>
                  <element value="url"/>
                  <transform value="copy"/>
                  <parameter>
                     <valueString value="Condition"/>
                  </parameter>
               </target>
               <target>
                  <context value="obs6"/>
                  <contextType value="variable"/>
                  <element value="focus"/>
                  <variable value="reference"/>
                  <transform value="create"/>
                  <parameter>
                     <valueString value="Reference"/>
                  </parameter>
               </target>
               <target>
                  <context value="reference"/>
                  <contextType value="variable"/>
                  <element value="reference"/>
                  <transform value="evaluate"/>
                  <parameter>
                     <valueString value="'https://example/Condition/' + %condition1.id"/>
                  </parameter>
               </target>
               <dependent>
                  <name value="ConditionFunction"/>
                  <variable value="entryobs">
                     <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                        <valueUrl value="id"/>
                     </extension>
                  </variable>
                  <variable value="condition1">
                     <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                        <valueUrl value="id"/>
                     </extension>
                  </variable>
                  <variable value="patient">
                     <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                        <valueUrl value="id"/>
                     </extension>
                  </variable>
                  <variable value="encounter">
                     <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                        <valueUrl value="id"/>
                     </extension>
                  </variable>
                  <variable value="bundle">
                     <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                        <valueUrl value="id"/>
                     </extension>
                  </variable>
               </dependent>
            </rule>
         </rule>
         <rule>
            <name value="precedenti esami"/>
            <source>
               <context value="section"/>
               <condition value="(code.code = '55114-3')"/>
            </source>
            <target>
               <context value="bundle"/>
               <contextType value="variable"/>
               <element value="entry"/>
               <variable value="e9"/>
            </target>
            <target>
               <context value="e9"/>
               <contextType value="variable"/>
               <element value="request"/>
               <variable value="request"/>
               <transform value="create"/>
               <parameter>
                  <valueString value="BackboneElement"/>
               </parameter>
            </target>
            <target>
               <context value="request"/>
               <contextType value="variable"/>
               <element value="method"/>
               <transform value="copy"/>
               <parameter>
                  <valueString value="POST"/>
               </parameter>
            </target>
            <target>
               <context value="e9"/>
               <contextType value="variable"/>
               <element value="resource"/>
               <variable value="obs9"/>
               <transform value="create"/>
               <parameter>
                  <valueString value="Observation"/>
               </parameter>
            </target>
            <target>
               <context value="obs9"/>
               <contextType value="variable"/>
               <element value="id"/>
               <variable value="uuid9"/>
               <transform value="uuid"/>
            </target>
            <target>
               <context value="e9"/>
               <contextType value="variable"/>
               <element value="fullUrl"/>
               <transform value="append"/>
               <parameter>
                  <valueString value="https://example/Observation/"/>
               </parameter>
               <parameter>
                  <valueId value="uuid9"/>
               </parameter>
            </target>
            <target>
               <context value="request"/>
               <contextType value="variable"/>
               <element value="url"/>
               <transform value="copy"/>
               <parameter>
                  <valueString value="Observation"/>
               </parameter>
            </target>
            <target>
               <context value="dReport"/>
               <contextType value="variable"/>
               <element value="result"/>
               <variable value="reference"/>
               <transform value="create"/>
               <parameter>
                  <valueString value="Reference"/>
               </parameter>
            </target>
            <target>
               <context value="reference"/>
               <contextType value="variable"/>
               <element value="reference"/>
               <transform value="evaluate"/>
               <parameter>
                  <valueString value="'https://example/Observation/' + %obs9.id"/>
               </parameter>
            </target>
            <dependent>
               <name value="Observation"/>
               <variable value="entryobs">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="patient">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="encounter">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="obs9">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="bundle">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
            </dependent>
         </rule>
         <rule>
            <name value="complicanze"/>
            <source>
               <context value="section"/>
               <condition value="(code.code = '55109-3')"/>
            </source>
            <target>
               <context value="bundle"/>
               <contextType value="variable"/>
               <element value="entry"/>
               <variable value="e8"/>
            </target>
            <target>
               <context value="e8"/>
               <contextType value="variable"/>
               <element value="request"/>
               <variable value="request"/>
               <transform value="create"/>
               <parameter>
                  <valueString value="BackboneElement"/>
               </parameter>
            </target>
            <target>
               <context value="request"/>
               <contextType value="variable"/>
               <element value="method"/>
               <transform value="copy"/>
               <parameter>
                  <valueString value="POST"/>
               </parameter>
            </target>
            <target>
               <context value="e8"/>
               <contextType value="variable"/>
               <element value="resource"/>
               <variable value="obs8"/>
               <transform value="create"/>
               <parameter>
                  <valueString value="Observation"/>
               </parameter>
            </target>
            <target>
               <context value="obs8"/>
               <contextType value="variable"/>
               <element value="id"/>
               <variable value="uuid8"/>
               <transform value="uuid"/>
            </target>
            <target>
               <context value="e8"/>
               <contextType value="variable"/>
               <element value="fullUrl"/>
               <transform value="append"/>
               <parameter>
                  <valueString value="https://example/Observation/"/>
               </parameter>
               <parameter>
                  <valueId value="uuid8"/>
               </parameter>
            </target>
            <target>
               <context value="request"/>
               <contextType value="variable"/>
               <element value="url"/>
               <transform value="copy"/>
               <parameter>
                  <valueString value="Observation"/>
               </parameter>
            </target>
            <target>
               <context value="dReport"/>
               <contextType value="variable"/>
               <element value="result"/>
               <variable value="reference"/>
               <transform value="create"/>
               <parameter>
                  <valueString value="Reference"/>
               </parameter>
            </target>
            <target>
               <context value="reference"/>
               <contextType value="variable"/>
               <element value="reference"/>
               <transform value="evaluate"/>
               <parameter>
                  <valueString value="'https://example/Observation/' + %obs8.id"/>
               </parameter>
            </target>
            <dependent>
               <name value="Observation"/>
               <variable value="entryobs">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="patient">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="encounter">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="obs8">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="bundle">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
            </dependent>
         </rule>
         <rule>
            <name value="quesitoDiagnostico"/>
            <source>
               <context value="section"/>
               <condition value="(code.code = '18785-6')"/>
            </source>
            <target>
               <context value="bundle"/>
               <contextType value="variable"/>
               <element value="entry"/>
               <variable value="e14"/>
            </target>
            <target>
               <context value="e14"/>
               <contextType value="variable"/>
               <element value="request"/>
               <variable value="request"/>
               <transform value="create"/>
               <parameter>
                  <valueString value="BackboneElement"/>
               </parameter>
            </target>
            <target>
               <context value="request"/>
               <contextType value="variable"/>
               <element value="method"/>
               <transform value="copy"/>
               <parameter>
                  <valueString value="POST"/>
               </parameter>
            </target>
            <target>
               <context value="e14"/>
               <contextType value="variable"/>
               <element value="resource"/>
               <variable value="obs14"/>
               <transform value="create"/>
               <parameter>
                  <valueString value="Observation"/>
               </parameter>
            </target>
            <target>
               <context value="obs14"/>
               <contextType value="variable"/>
               <element value="id"/>
               <variable value="uuid14"/>
               <transform value="uuid"/>
            </target>
            <target>
               <context value="e14"/>
               <contextType value="variable"/>
               <element value="fullUrl"/>
               <transform value="append"/>
               <parameter>
                  <valueString value="https://example/Observation/"/>
               </parameter>
               <parameter>
                  <valueId value="uuid14"/>
               </parameter>
            </target>
            <target>
               <context value="request"/>
               <contextType value="variable"/>
               <element value="url"/>
               <transform value="copy"/>
               <parameter>
                  <valueString value="Observation"/>
               </parameter>
            </target>
            <target>
               <context value="dReport"/>
               <contextType value="variable"/>
               <element value="result"/>
               <variable value="reference"/>
               <transform value="create"/>
               <parameter>
                  <valueString value="Reference"/>
               </parameter>
            </target>
            <target>
               <context value="reference"/>
               <contextType value="variable"/>
               <element value="reference"/>
               <transform value="evaluate"/>
               <parameter>
                  <valueString value="'https://example/Observation/' + %obs14.id"/>
               </parameter>
            </target>
            <dependent>
               <name value="Observation"/>
               <variable value="entryobs">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="patient">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="encounter">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="obs14">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
               <variable value="bundle">
                  <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                     <valueUrl value="id"/>
                  </extension>
               </variable>
            </dependent>
         </rule>
      </rule>
      <rule>
         <name value="organizer"/>
         <source>
            <context value="src"/>
            <element value="organizer"/>
            <variable value="organizer"/>
         </source>
         <rule>
            <name value="entryOrganizer"/>
            <source>
               <context value="src"/>
            </source>
            <target>
               <context value="bundle"/>
               <contextType value="variable"/>
               <element value="entry"/>
               <variable value="e10"/>
            </target>
            <target>
               <context value="e10"/>
               <contextType value="variable"/>
               <element value="request"/>
               <variable value="request"/>
               <transform value="create"/>
               <parameter>
                  <valueString value="BackboneElement"/>
               </parameter>
            </target>
            <target>
               <context value="request"/>
               <contextType value="variable"/>
               <element value="method"/>
               <transform value="copy"/>
               <parameter>
                  <valueString value="POST"/>
               </parameter>
            </target>
            <target>
               <context value="e10"/>
               <contextType value="variable"/>
               <element value="resource"/>
               <variable value="obs10"/>
               <transform value="create"/>
               <parameter>
                  <valueString value="Observation"/>
               </parameter>
            </target>
            <target>
               <context value="obs10"/>
               <contextType value="variable"/>
               <element value="id"/>
               <variable value="uuid10"/>
               <transform value="uuid"/>
            </target>
            <target>
               <context value="e10"/>
               <contextType value="variable"/>
               <element value="fullUrl"/>
               <transform value="append"/>
               <parameter>
                  <valueString value="https://example/Observation/"/>
               </parameter>
               <parameter>
                  <valueId value="uuid10"/>
               </parameter>
            </target>
            <target>
               <context value="request"/>
               <contextType value="variable"/>
               <element value="url"/>
               <transform value="copy"/>
               <parameter>
                  <valueString value="Observation"/>
               </parameter>
            </target>
            <target>
               <context value="dReport"/>
               <contextType value="variable"/>
               <element value="result"/>
               <variable value="reference"/>
               <transform value="create"/>
               <parameter>
                  <valueString value="Reference"/>
               </parameter>
            </target>
            <target>
               <context value="reference"/>
               <contextType value="variable"/>
               <element value="reference"/>
               <transform value="evaluate"/>
               <parameter>
                  <valueString value="'https://example/Observation/' + %obs10.id"/>
               </parameter>
            </target>
            <rule>
               <name value="reference"/>
               <source>
                  <context value="section"/>
               </source>
               <target>
                  <context value="obs10"/>
                  <contextType value="variable"/>
                  <element value="subject"/>
                  <variable value="reference"/>
                  <transform value="create"/>
                  <parameter>
                     <valueString value="Reference"/>
                  </parameter>
               </target>
               <target>
                  <context value="reference"/>
                  <contextType value="variable"/>
                  <element value="reference"/>
                  <transform value="evaluate"/>
                  <parameter>
                     <valueString value="'https://example/Patient/' + %patient.id"/>
                  </parameter>
               </target>
            </rule>
            <rule>
               <name value="reference"/>
               <source>
                  <context value="section"/>
               </source>
               <target>
                  <context value="obs10"/>
                  <contextType value="variable"/>
                  <element value="encounter"/>
                  <variable value="reference"/>
                  <transform value="create"/>
                  <parameter>
                     <valueString value="Reference"/>
                  </parameter>
               </target>
               <target>
                  <context value="reference"/>
                  <contextType value="variable"/>
                  <element value="reference"/>
                  <transform value="evaluate"/>
                  <parameter>
                     <valueString value="'https://example/Encounter/' + %encounter.id"/>
                  </parameter>
               </target>
            </rule>
            <rule>
               <name value="tatusobse"/>
               <source>
                  <context value="section"/>
               </source>
               <target>
                  <context value="obs10"/>
                  <contextType value="variable"/>
                  <element value="status"/>
                  <transform value="copy"/>
                  <parameter>
                     <valueString value="final"/>
                  </parameter>
               </target>
            </rule>
            <rule>
               <name value="codeObs"/>
               <source>
                  <context value="section"/>
                  <element value="code"/>
                  <variable value="vvv"/>
               </source>
               <target>
                  <context value="obs10"/>
                  <contextType value="variable"/>
                  <element value="code"/>
                  <variable value="vvv"/>
                  <transform value="create"/>
               </target>
            </rule>
            <rule>
               <name value="List"/>
               <source>
                  <context value="section"/>
               </source>
               <target>
                  <context value="bundle"/>
                  <contextType value="variable"/>
                  <element value="entry"/>
                  <variable value="e11"/>
               </target>
               <target>
                  <context value="e11"/>
                  <contextType value="variable"/>
                  <element value="request"/>
                  <variable value="request"/>
                  <transform value="create"/>
                  <parameter>
                     <valueString value="BackboneElement"/>
                  </parameter>
               </target>
               <target>
                  <context value="request"/>
                  <contextType value="variable"/>
                  <element value="method"/>
                  <transform value="copy"/>
                  <parameter>
                     <valueString value="POST"/>
                  </parameter>
               </target>
               <target>
                  <context value="e11"/>
                  <contextType value="variable"/>
                  <element value="resource"/>
                  <variable value="list11"/>
                  <transform value="create"/>
                  <parameter>
                     <valueString value="List"/>
                  </parameter>
               </target>
               <target>
                  <context value="list11"/>
                  <contextType value="variable"/>
                  <element value="id"/>
                  <variable value="uuid11"/>
                  <transform value="uuid"/>
               </target>
               <target>
                  <context value="e11"/>
                  <contextType value="variable"/>
                  <element value="fullUrl"/>
                  <transform value="append"/>
                  <parameter>
                     <valueString value="https://example/List/"/>
                  </parameter>
                  <parameter>
                     <valueId value="uuid11"/>
                  </parameter>
               </target>
               <target>
                  <context value="request"/>
                  <contextType value="variable"/>
                  <element value="url"/>
                  <transform value="copy"/>
                  <parameter>
                     <valueString value="List"/>
                  </parameter>
               </target>
               <target>
                  <context value="obs10"/>
                  <contextType value="variable"/>
                  <element value="focus"/>
                  <variable value="reference"/>
                  <transform value="create"/>
                  <parameter>
                     <valueString value="Reference"/>
                  </parameter>
               </target>
               <target>
                  <context value="reference"/>
                  <contextType value="variable"/>
                  <element value="reference"/>
                  <transform value="evaluate"/>
                  <parameter>
                     <valueString value="'https://example/List/' + %list11.id"/>
                  </parameter>
               </target>
               <rule>
                  <name value="reference"/>
                  <source>
                     <context value="section"/>
                  </source>
                  <target>
                     <context value="list11"/>
                     <contextType value="variable"/>
                     <element value="subject"/>
                     <variable value="reference"/>
                     <transform value="create"/>
                     <parameter>
                        <valueString value="Reference"/>
                     </parameter>
                  </target>
                  <target>
                     <context value="reference"/>
                     <contextType value="variable"/>
                     <element value="reference"/>
                     <transform value="evaluate"/>
                     <parameter>
                        <valueString value="'https://example/Patient/' + %patient.id"/>
                     </parameter>
                  </target>
               </rule>
               <rule>
                  <name value="liststat"/>
                  <source>
                     <context value="section"/>
                  </source>
                  <target>
                     <context value="list11"/>
                     <contextType value="variable"/>
                     <element value="status"/>
                     <transform value="copy"/>
                     <parameter>
                        <valueString value="current"/>
                     </parameter>
                  </target>
               </rule>
               <rule>
                  <name value="listmd"/>
                  <source>
                     <context value="section"/>
                  </source>
                  <target>
                     <context value="list11"/>
                     <contextType value="variable"/>
                     <element value="mode"/>
                     <transform value="copy"/>
                     <parameter>
                        <valueString value="working"/>
                     </parameter>
                  </target>
               </rule>
               <rule>
                  <name value="reference"/>
                  <source>
                     <context value="section"/>
                  </source>
                  <target>
                     <context value="list11"/>
                     <contextType value="variable"/>
                     <element value="encounter"/>
                     <variable value="reference"/>
                     <transform value="create"/>
                     <parameter>
                        <valueString value="Reference"/>
                     </parameter>
                  </target>
                  <target>
                     <context value="reference"/>
                     <contextType value="variable"/>
                     <element value="reference"/>
                     <transform value="evaluate"/>
                     <parameter>
                        <valueString value="'https://example/Encounter/' + %encounter.id"/>
                     </parameter>
                  </target>
               </rule>
               <rule>
                  <name value="org"/>
                  <source>
                     <context value="organizer"/>
                  </source>
                  <target>
                     <context value="list11"/>
                     <contextType value="variable"/>
                     <element value="entry"/>
                     <variable value="entryList2"/>
                  </target>
                  <rule>
                     <name value="family"/>
                     <source>
                        <context value="organizer"/>
                     </source>
                     <target>
                        <context value="bundle"/>
                        <contextType value="variable"/>
                        <element value="entry"/>
                        <variable value="e12"/>
                     </target>
                     <target>
                        <context value="e12"/>
                        <contextType value="variable"/>
                        <element value="request"/>
                        <variable value="request"/>
                        <transform value="create"/>
                        <parameter>
                           <valueString value="BackboneElement"/>
                        </parameter>
                     </target>
                     <target>
                        <context value="request"/>
                        <contextType value="variable"/>
                        <element value="method"/>
                        <transform value="copy"/>
                        <parameter>
                           <valueString value="POST"/>
                        </parameter>
                     </target>
                     <target>
                        <context value="e12"/>
                        <contextType value="variable"/>
                        <element value="resource"/>
                        <variable value="familyMember"/>
                        <transform value="create"/>
                        <parameter>
                           <valueString value="FamilyMemberHistory"/>
                        </parameter>
                     </target>
                     <target>
                        <context value="familyMember"/>
                        <contextType value="variable"/>
                        <element value="id"/>
                        <variable value="uuid12"/>
                        <transform value="uuid"/>
                     </target>
                     <target>
                        <context value="e12"/>
                        <contextType value="variable"/>
                        <element value="fullUrl"/>
                        <transform value="append"/>
                        <parameter>
                           <valueString value="https://example/FamilyMemberHistory/"/>
                        </parameter>
                        <parameter>
                           <valueId value="uuid12"/>
                        </parameter>
                     </target>
                     <target>
                        <context value="request"/>
                        <contextType value="variable"/>
                        <element value="url"/>
                        <transform value="copy"/>
                        <parameter>
                           <valueString value="FamilyMemberHistory"/>
                        </parameter>
                     </target>
                     <target>
                        <context value="entryList2"/>
                        <contextType value="variable"/>
                        <element value="item"/>
                        <variable value="reference"/>
                        <transform value="create"/>
                        <parameter>
                           <valueString value="Reference"/>
                        </parameter>
                     </target>
                     <target>
                        <context value="reference"/>
                        <contextType value="variable"/>
                        <element value="reference"/>
                        <transform value="evaluate"/>
                        <parameter>
                           <valueString value="'https://example/FamilyMemberHistory/' + %familyMember.id"/>
                        </parameter>
                     </target>
                     <dependent>
                        <name value="FamilyMemberFunction"/>
                        <variable value="organizer">
                           <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                              <valueUrl value="id"/>
                           </extension>
                        </variable>
                        <variable value="familyMember">
                           <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                              <valueUrl value="id"/>
                           </extension>
                        </variable>
                        <variable value="patient">
                           <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                              <valueUrl value="id"/>
                           </extension>
                        </variable>
                     </dependent>
                  </rule>
               </rule>
            </rule>
         </rule>
      </rule>
      <rule>
         <name value="whereCond"/>
         <source>
            <context value="section"/>
            <condition value="section.entry.exists().not()"/>
         </source>
         <rule>
            <name value="NonConclusion"/>
            <source>
               <context value="section"/>
               <condition value="(code.code = '55110-1').not()"/>
            </source>
            <rule>
               <name value="txtsec"/>
               <source>
                  <context value="section"/>
                  <element value="text"/>
                  <variable value="text"/>
               </source>
               <target>
                  <context value="bundle"/>
                  <contextType value="variable"/>
                  <element value="entry"/>
                  <variable value="e13"/>
               </target>
               <target>
                  <context value="e13"/>
                  <contextType value="variable"/>
                  <element value="request"/>
                  <variable value="request"/>
                  <transform value="create"/>
                  <parameter>
                     <valueString value="BackboneElement"/>
                  </parameter>
               </target>
               <target>
                  <context value="request"/>
                  <contextType value="variable"/>
                  <element value="method"/>
                  <transform value="copy"/>
                  <parameter>
                     <valueString value="POST"/>
                  </parameter>
               </target>
               <target>
                  <context value="e13"/>
                  <contextType value="variable"/>
                  <element value="resource"/>
                  <variable value="obs13"/>
                  <transform value="create"/>
                  <parameter>
                     <valueString value="Observation"/>
                  </parameter>
               </target>
               <target>
                  <context value="obs13"/>
                  <contextType value="variable"/>
                  <element value="id"/>
                  <variable value="uuid13"/>
                  <transform value="uuid"/>
               </target>
               <target>
                  <context value="e13"/>
                  <contextType value="variable"/>
                  <element value="fullUrl"/>
                  <transform value="append"/>
                  <parameter>
                     <valueString value="https://example/Observation/"/>
                  </parameter>
                  <parameter>
                     <valueId value="uuid13"/>
                  </parameter>
               </target>
               <target>
                  <context value="request"/>
                  <contextType value="variable"/>
                  <element value="url"/>
                  <transform value="copy"/>
                  <parameter>
                     <valueString value="Observation"/>
                  </parameter>
               </target>
               <target>
                  <context value="dReport"/>
                  <contextType value="variable"/>
                  <element value="result"/>
                  <variable value="reference"/>
                  <transform value="create"/>
                  <parameter>
                     <valueString value="Reference"/>
                  </parameter>
               </target>
               <target>
                  <context value="reference"/>
                  <contextType value="variable"/>
                  <element value="reference"/>
                  <transform value="evaluate"/>
                  <parameter>
                     <valueString value="'https://example/Observation/' + %obs13.id"/>
                  </parameter>
               </target>
               <rule>
                  <name value="reference"/>
                  <source>
                     <context value="section"/>
                  </source>
                  <target>
                     <context value="obs13"/>
                     <contextType value="variable"/>
                     <element value="subject"/>
                     <variable value="reference"/>
                     <transform value="create"/>
                     <parameter>
                        <valueString value="Reference"/>
                     </parameter>
                  </target>
                  <target>
                     <context value="reference"/>
                     <contextType value="variable"/>
                     <element value="reference"/>
                     <transform value="evaluate"/>
                     <parameter>
                        <valueString value="'https://example/Patient/' + %patient.id"/>
                     </parameter>
                  </target>
               </rule>
               <rule>
                  <name value="reference"/>
                  <source>
                     <context value="section"/>
                  </source>
                  <target>
                     <context value="obs13"/>
                     <contextType value="variable"/>
                     <element value="encounter"/>
                     <variable value="reference"/>
                     <transform value="create"/>
                     <parameter>
                        <valueString value="Reference"/>
                     </parameter>
                  </target>
                  <target>
                     <context value="reference"/>
                     <contextType value="variable"/>
                     <element value="reference"/>
                     <transform value="evaluate"/>
                     <parameter>
                        <valueString value="'https://example/Encounter/' + %encounter.id"/>
                     </parameter>
                  </target>
               </rule>
               <rule>
                  <name value="obsst"/>
                  <source>
                     <context value="section"/>
                  </source>
                  <target>
                     <context value="obs13"/>
                     <contextType value="variable"/>
                     <element value="status"/>
                     <transform value="copy"/>
                     <parameter>
                        <valueString value="preliminary"/>
                     </parameter>
                  </target>
               </rule>
               <rule>
                  <name value="obscde"/>
                  <source>
                     <context value="section"/>
                     <element value="code"/>
                     <variable value="vvv"/>
                  </source>
                  <target>
                     <context value="obs13"/>
                     <contextType value="variable"/>
                     <element value="code"/>
                     <variable value="vvv"/>
                     <transform value="create"/>
                  </target>
               </rule>
               <rule>
                  <name value="statusS"/>
                  <source>
                     <context value="section"/>
                  </source>
                  <target>
                     <context value="obs13"/>
                     <contextType value="variable"/>
                     <element value="status"/>
                     <transform value="copy"/>
                     <parameter>
                        <valueString value="final"/>
                     </parameter>
                  </target>
               </rule>
               <rule>
                  <name value="narrative"/>
                  <source>
                     <context value="text"/>
                  </source>
                  <target>
                     <context value="obs13"/>
                     <contextType value="variable"/>
                     <element value="note"/>
                     <variable value="note"/>
                  </target>
                  <rule>
                     <name value="note"/>
                     <source>
                        <context value="text"/>
                        <variable value="t"/>
                     </source>
                     <target>
                        <context value="note"/>
                        <contextType value="variable"/>
                        <element value="text"/>
                        <variable value="textNote"/>
                        <transform value="create"/>
                        <parameter>
                           <valueString value="string"/>
                        </parameter>
                     </target>
                     <dependent>
                        <name value="EDstring"/>
                        <variable value="t">
                           <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                              <valueUrl value="id"/>
                           </extension>
                        </variable>
                        <variable value="textNote">
                           <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                              <valueUrl value="id"/>
                           </extension>
                        </variable>
                     </dependent>
                  </rule>
               </rule>
            </rule>
         </rule>
         <rule>
            <name value="conclusion"/>
            <source>
               <context value="section"/>
               <condition value="(code.code = '55110-1')"/>
            </source>
            <rule>
               <name value="conc"/>
               <source>
                  <context value="section"/>
                  <element value="text"/>
                  <variable value="t"/>
               </source>
               <target>
                  <context value="dReport"/>
                  <contextType value="variable"/>
                  <element value="conclusion"/>
                  <variable value="textConclusion"/>
                  <transform value="create"/>
                  <parameter>
                     <valueString value="string"/>
                  </parameter>
               </target>
               <dependent>
                  <name value="EDstring"/>
                  <variable value="t">
                     <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                        <valueUrl value="id"/>
                     </extension>
                  </variable>
                  <variable value="textConclusion">
                     <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                        <valueUrl value="id"/>
                     </extension>
                  </variable>
               </dependent>
            </rule>
         </rule>
      </rule>
   </group>
   <group>
      <name value="Observation"/>
      <typeMode value="none"/>
      <input>
         <name value="cda"/>
         <type value="observation"/>
         <mode value="source"/>
      </input>
      <input>
         <name value="patient"/>
         <type value="Patient"/>
         <mode value="target"/>
      </input>
      <input>
         <name value="encounter"/>
         <type value="Encounter"/>
         <mode value="target"/>
      </input>
      <input>
         <name value="ob"/>
         <type value="Observation"/>
         <mode value="target"/>
      </input>
      <input>
         <name value="bundle"/>
         <type value="Bundle"/>
         <mode value="target"/>
      </input>
      <rule>
         <name value="reference"/>
         <source>
            <context value="cda"/>
         </source>
         <target>
            <context value="ob"/>
            <contextType value="variable"/>
            <element value="subject"/>
            <variable value="reference"/>
            <transform value="create"/>
            <parameter>
               <valueString value="Reference"/>
            </parameter>
         </target>
         <target>
            <context value="reference"/>
            <contextType value="variable"/>
            <element value="reference"/>
            <transform value="evaluate"/>
            <parameter>
               <valueString value="'https://example/Patient/' + %patient.id"/>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="reference"/>
         <source>
            <context value="cda"/>
         </source>
         <target>
            <context value="ob"/>
            <contextType value="variable"/>
            <element value="encounter"/>
            <variable value="reference"/>
            <transform value="create"/>
            <parameter>
               <valueString value="Reference"/>
            </parameter>
         </target>
         <target>
            <context value="reference"/>
            <contextType value="variable"/>
            <element value="reference"/>
            <transform value="evaluate"/>
            <parameter>
               <valueString value="'https://example/Encounter/' + %encounter.id"/>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="code"/>
         <source>
            <context value="cda"/>
            <element value="code"/>
            <variable value="vvv"/>
         </source>
         <target>
            <context value="ob"/>
            <contextType value="variable"/>
            <element value="code"/>
            <variable value="vvv"/>
            <transform value="create"/>
         </target>
      </rule>
      <rule>
         <name value="Stats"/>
         <source>
            <context value="cda"/>
         </source>
         <target>
            <context value="ob"/>
            <contextType value="variable"/>
            <element value="status"/>
            <transform value="copy"/>
            <parameter>
               <valueString value="final"/>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="value"/>
         <source>
            <context value="cda"/>
            <type value="ST"/>
            <element value="value"/>
            <variable value="st"/>
         </source>
         <target>
            <context value="ob"/>
            <contextType value="variable"/>
            <element value="value"/>
            <transform value="create"/>
            <parameter>
               <valueString value="string"/>
            </parameter>
         </target>
         <target>
            <context value="ob"/>
            <contextType value="variable"/>
            <element value="value"/>
            <transform value="evaluate"/>
            <parameter>
               <valueString value="st.dataString"/>
            </parameter>
         </target>
         <documentation value="value datatype"/>
      </rule>
      <rule>
         <name value="boolean"/>
         <source>
            <context value="cda"/>
            <type value="BL"/>
            <element value="value"/>
            <variable value="boolean"/>
         </source>
         <target>
            <context value="ob"/>
            <contextType value="variable"/>
            <element value="value"/>
            <transform value="evaluate"/>
            <parameter>
               <valueString value="boolean.value"/>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="value"/>
         <source>
            <context value="cda"/>
            <type value="INT"/>
            <element value="value"/>
            <variable value="int"/>
         </source>
         <target>
            <context value="ob"/>
            <contextType value="variable"/>
            <element value="value"/>
            <transform value="evaluate"/>
            <parameter>
               <valueString value="int.value"/>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="val"/>
         <source>
            <context value="cda"/>
            <type value="CE"/>
            <element value="value"/>
            <variable value="val"/>
         </source>
         <rule>
            <name value="coding"/>
            <source>
               <context value="val"/>
            </source>
            <target>
               <context value="ob"/>
               <contextType value="variable"/>
               <element value="value"/>
               <variable value="ce"/>
               <transform value="create"/>
               <parameter>
                  <valueString value="CodeableConcept"/>
               </parameter>
            </target>
            <rule>
               <name value="originalText"/>
               <source>
                  <context value="val"/>
                  <element value="originalText"/>
                  <variable value="originalText"/>
               </source>
               <rule>
                  <name value="reference"/>
                  <source>
                     <context value="originalText"/>
                     <element value="reference"/>
                     <variable value="reference"/>
                  </source>
                  <target>
                     <context value="ce"/>
                     <contextType value="variable"/>
                     <element value="text"/>
                     <transform value="evaluate"/>
                     <parameter>
                        <valueString value="reference.value"/>
                     </parameter>
                  </target>
               </rule>
            </rule>
            <rule>
               <name value="code"/>
               <source>
                  <context value="val"/>
               </source>
               <target>
                  <context value="ce"/>
                  <contextType value="variable"/>
                  <element value="coding"/>
                  <variable value="coding"/>
               </target>
               <rule>
                  <name value="code"/>
                  <source>
                     <context value="val"/>
                     <element value="code"/>
                     <variable value="code"/>
                  </source>
                  <target>
                     <context value="coding"/>
                     <contextType value="variable"/>
                     <element value="code"/>
                     <transform value="cast"/>
                     <parameter>
                        <valueId value="code"/>
                     </parameter>
                     <parameter>
                        <valueString value="string"/>
                     </parameter>
                  </target>
               </rule>
               <rule>
                  <name value="codeSystem"/>
                  <source>
                     <context value="val"/>
                     <element value="codeSystem"/>
                     <variable value="system"/>
                  </source>
                  <target>
                     <context value="coding"/>
                     <contextType value="variable"/>
                     <element value="system"/>
                     <transform value="translate"/>
                     <parameter>
                        <valueId value="system"/>
                     </parameter>
                     <parameter>
                        <valueString value="http://hl7.org/fhir/ConceptMap/special-oid2uri"/>
                     </parameter>
                     <parameter>
                        <valueString value="uri"/>
                     </parameter>
                  </target>
               </rule>
               <rule>
                  <name value="displayName"/>
                  <source>
                     <context value="val"/>
                     <element value="displayName"/>
                     <variable value="display"/>
                  </source>
                  <target>
                     <context value="coding"/>
                     <contextType value="variable"/>
                     <element value="display"/>
                     <transform value="cast"/>
                     <parameter>
                        <valueId value="display"/>
                     </parameter>
                     <parameter>
                        <valueString value="string"/>
                     </parameter>
                  </target>
               </rule>
            </rule>
            <rule>
               <name value="translation"/>
               <source>
                  <context value="val"/>
                  <element value="translation"/>
                  <variable value="translation"/>
               </source>
               <target>
                  <context value="ce"/>
                  <contextType value="variable"/>
                  <element value="coding"/>
                  <variable value="coding"/>
               </target>
               <rule>
                  <name value="code"/>
                  <source>
                     <context value="translation"/>
                     <element value="code"/>
                     <variable value="code"/>
                  </source>
                  <target>
                     <context value="coding"/>
                     <contextType value="variable"/>
                     <element value="code"/>
                     <transform value="cast"/>
                     <parameter>
                        <valueId value="code"/>
                     </parameter>
                     <parameter>
                        <valueString value="string"/>
                     </parameter>
                  </target>
               </rule>
               <rule>
                  <name value="codeSystem"/>
                  <source>
                     <context value="translation"/>
                     <element value="codeSystem"/>
                     <variable value="system"/>
                  </source>
                  <target>
                     <context value="coding"/>
                     <contextType value="variable"/>
                     <element value="system"/>
                     <transform value="translate"/>
                     <parameter>
                        <valueId value="system"/>
                     </parameter>
                     <parameter>
                        <valueString value="http://hl7.org/fhir/ConceptMap/special-oid2uri"/>
                     </parameter>
                     <parameter>
                        <valueString value="uri"/>
                     </parameter>
                  </target>
               </rule>
               <rule>
                  <name value="displayName"/>
                  <source>
                     <context value="translation"/>
                     <element value="displayName"/>
                     <variable value="display"/>
                  </source>
                  <target>
                     <context value="coding"/>
                     <contextType value="variable"/>
                     <element value="display"/>
                     <transform value="cast"/>
                     <parameter>
                        <valueId value="display"/>
                     </parameter>
                     <parameter>
                        <valueString value="string"/>
                     </parameter>
                  </target>
               </rule>
               <rule>
                  <name value="qualifier"/>
                  <source>
                     <context value="translation"/>
                     <element value="qualifier"/>
                     <variable value="qualifier"/>
                  </source>
                  <rule>
                     <name value="value"/>
                     <source>
                        <context value="qualifier"/>
                        <element value="value"/>
                        <variable value="value"/>
                     </source>
                     <target>
                        <context value="ce"/>
                        <contextType value="variable"/>
                        <element value="coding"/>
                        <variable value="coding"/>
                     </target>
                     <rule>
                        <name value="code"/>
                        <source>
                           <context value="value"/>
                           <element value="code"/>
                           <variable value="code"/>
                        </source>
                        <target>
                           <context value="coding"/>
                           <contextType value="variable"/>
                           <element value="code"/>
                           <transform value="cast"/>
                           <parameter>
                              <valueId value="code"/>
                           </parameter>
                           <parameter>
                              <valueString value="string"/>
                           </parameter>
                        </target>
                     </rule>
                     <rule>
                        <name value="codeSystem"/>
                        <source>
                           <context value="value"/>
                           <element value="codeSystem"/>
                           <variable value="system"/>
                        </source>
                        <target>
                           <context value="coding"/>
                           <contextType value="variable"/>
                           <element value="system"/>
                           <transform value="translate"/>
                           <parameter>
                              <valueId value="system"/>
                           </parameter>
                           <parameter>
                              <valueString value="http://hl7.org/fhir/ConceptMap/special-oid2uri"/>
                           </parameter>
                           <parameter>
                              <valueString value="uri"/>
                           </parameter>
                        </target>
                     </rule>
                     <rule>
                        <name value="displayName"/>
                        <source>
                           <context value="value"/>
                           <element value="displayName"/>
                           <variable value="display"/>
                        </source>
                        <target>
                           <context value="coding"/>
                           <contextType value="variable"/>
                           <element value="display"/>
                           <transform value="cast"/>
                           <parameter>
                              <valueId value="display"/>
                           </parameter>
                           <parameter>
                              <valueString value="string"/>
                           </parameter>
                        </target>
                     </rule>
                  </rule>
               </rule>
            </rule>
         </rule>
      </rule>
      <rule>
         <name value="val"/>
         <source>
            <context value="cda"/>
            <type value="CD"/>
            <element value="value"/>
            <variable value="val"/>
         </source>
         <rule>
            <name value="coding"/>
            <source>
               <context value="val"/>
            </source>
            <target>
               <context value="ob"/>
               <contextType value="variable"/>
               <element value="value"/>
               <variable value="ce"/>
               <transform value="create"/>
               <parameter>
                  <valueString value="CodeableConcept"/>
               </parameter>
            </target>
            <rule>
               <name value="originalText"/>
               <source>
                  <context value="val"/>
                  <element value="originalText"/>
                  <variable value="originalText"/>
               </source>
               <rule>
                  <name value="reference"/>
                  <source>
                     <context value="originalText"/>
                     <element value="reference"/>
                     <variable value="reference"/>
                  </source>
                  <target>
                     <context value="ce"/>
                     <contextType value="variable"/>
                     <element value="text"/>
                     <transform value="evaluate"/>
                     <parameter>
                        <valueString value="reference.value"/>
                     </parameter>
                  </target>
               </rule>
            </rule>
            <rule>
               <name value="code"/>
               <source>
                  <context value="val"/>
               </source>
               <target>
                  <context value="ce"/>
                  <contextType value="variable"/>
                  <element value="coding"/>
                  <variable value="coding"/>
               </target>
               <rule>
                  <name value="code"/>
                  <source>
                     <context value="val"/>
                     <element value="code"/>
                     <variable value="code"/>
                  </source>
                  <target>
                     <context value="coding"/>
                     <contextType value="variable"/>
                     <element value="code"/>
                     <transform value="cast"/>
                     <parameter>
                        <valueId value="code"/>
                     </parameter>
                     <parameter>
                        <valueString value="string"/>
                     </parameter>
                  </target>
               </rule>
               <rule>
                  <name value="codeSystem"/>
                  <source>
                     <context value="val"/>
                     <element value="codeSystem"/>
                     <variable value="system"/>
                  </source>
                  <target>
                     <context value="coding"/>
                     <contextType value="variable"/>
                     <element value="system"/>
                     <transform value="translate"/>
                     <parameter>
                        <valueId value="system"/>
                     </parameter>
                     <parameter>
                        <valueString value="http://hl7.org/fhir/ConceptMap/special-oid2uri"/>
                     </parameter>
                     <parameter>
                        <valueString value="uri"/>
                     </parameter>
                  </target>
               </rule>
               <rule>
                  <name value="displayName"/>
                  <source>
                     <context value="val"/>
                     <element value="displayName"/>
                     <variable value="display"/>
                  </source>
                  <target>
                     <context value="coding"/>
                     <contextType value="variable"/>
                     <element value="display"/>
                     <transform value="cast"/>
                     <parameter>
                        <valueId value="display"/>
                     </parameter>
                     <parameter>
                        <valueString value="string"/>
                     </parameter>
                  </target>
               </rule>
            </rule>
            <rule>
               <name value="translation"/>
               <source>
                  <context value="val"/>
                  <element value="translation"/>
                  <variable value="translation"/>
               </source>
               <target>
                  <context value="ce"/>
                  <contextType value="variable"/>
                  <element value="coding"/>
                  <variable value="coding"/>
               </target>
               <rule>
                  <name value="code"/>
                  <source>
                     <context value="translation"/>
                     <element value="code"/>
                     <variable value="code"/>
                  </source>
                  <target>
                     <context value="coding"/>
                     <contextType value="variable"/>
                     <element value="code"/>
                     <transform value="cast"/>
                     <parameter>
                        <valueId value="code"/>
                     </parameter>
                     <parameter>
                        <valueString value="string"/>
                     </parameter>
                  </target>
               </rule>
               <rule>
                  <name value="codeSystem"/>
                  <source>
                     <context value="translation"/>
                     <element value="codeSystem"/>
                     <variable value="system"/>
                  </source>
                  <target>
                     <context value="coding"/>
                     <contextType value="variable"/>
                     <element value="system"/>
                     <transform value="translate"/>
                     <parameter>
                        <valueId value="system"/>
                     </parameter>
                     <parameter>
                        <valueString value="http://hl7.org/fhir/ConceptMap/special-oid2uri"/>
                     </parameter>
                     <parameter>
                        <valueString value="uri"/>
                     </parameter>
                  </target>
               </rule>
               <rule>
                  <name value="displayName"/>
                  <source>
                     <context value="translation"/>
                     <element value="displayName"/>
                     <variable value="display"/>
                  </source>
                  <target>
                     <context value="coding"/>
                     <contextType value="variable"/>
                     <element value="display"/>
                     <transform value="cast"/>
                     <parameter>
                        <valueId value="display"/>
                     </parameter>
                     <parameter>
                        <valueString value="string"/>
                     </parameter>
                  </target>
               </rule>
               <rule>
                  <name value="qualifier"/>
                  <source>
                     <context value="translation"/>
                     <element value="qualifier"/>
                     <variable value="qualifier"/>
                  </source>
                  <rule>
                     <name value="value"/>
                     <source>
                        <context value="qualifier"/>
                        <element value="value"/>
                        <variable value="value"/>
                     </source>
                     <target>
                        <context value="ce"/>
                        <contextType value="variable"/>
                        <element value="coding"/>
                        <variable value="coding"/>
                     </target>
                     <rule>
                        <name value="code"/>
                        <source>
                           <context value="value"/>
                           <element value="code"/>
                           <variable value="code"/>
                        </source>
                        <target>
                           <context value="coding"/>
                           <contextType value="variable"/>
                           <element value="code"/>
                           <transform value="cast"/>
                           <parameter>
                              <valueId value="code"/>
                           </parameter>
                           <parameter>
                              <valueString value="string"/>
                           </parameter>
                        </target>
                     </rule>
                     <rule>
                        <name value="codeSystem"/>
                        <source>
                           <context value="value"/>
                           <element value="codeSystem"/>
                           <variable value="system"/>
                        </source>
                        <target>
                           <context value="coding"/>
                           <contextType value="variable"/>
                           <element value="system"/>
                           <transform value="translate"/>
                           <parameter>
                              <valueId value="system"/>
                           </parameter>
                           <parameter>
                              <valueString value="http://hl7.org/fhir/ConceptMap/special-oid2uri"/>
                           </parameter>
                           <parameter>
                              <valueString value="uri"/>
                           </parameter>
                        </target>
                     </rule>
                     <rule>
                        <name value="displayName"/>
                        <source>
                           <context value="value"/>
                           <element value="displayName"/>
                           <variable value="display"/>
                        </source>
                        <target>
                           <context value="coding"/>
                           <contextType value="variable"/>
                           <element value="display"/>
                           <transform value="cast"/>
                           <parameter>
                              <valueId value="display"/>
                           </parameter>
                           <parameter>
                              <valueString value="string"/>
                           </parameter>
                        </target>
                     </rule>
                  </rule>
               </rule>
            </rule>
         </rule>
      </rule>
      <rule>
         <name value="valueQuantity"/>
         <source>
            <context value="cda"/>
            <type value="PQ"/>
            <element value="value"/>
            <variable value="val"/>
         </source>
         <rule>
            <name value="quantity"/>
            <source>
               <context value="val"/>
            </source>
            <target>
               <context value="ob"/>
               <contextType value="variable"/>
               <element value="value"/>
               <variable value="quantity"/>
               <transform value="create"/>
               <parameter>
                  <valueString value="Quantity"/>
               </parameter>
            </target>
            <rule>
               <name value="value"/>
               <source>
                  <context value="val"/>
                  <element value="value"/>
                  <variable value="value"/>
               </source>
               <target>
                  <context value="quantity"/>
                  <contextType value="variable"/>
                  <element value="value"/>
                  <transform value="copy"/>
                  <parameter>
                     <valueId value="value"/>
                  </parameter>
               </target>
            </rule>
            <rule>
               <name value="unit"/>
               <source>
                  <context value="val"/>
                  <element value="unit"/>
                  <variable value="unit"/>
               </source>
               <target>
                  <context value="quantity"/>
                  <contextType value="variable"/>
                  <element value="unit"/>
                  <transform value="copy"/>
                  <parameter>
                     <valueId value="unit"/>
                  </parameter>
               </target>
            </rule>
         </rule>
      </rule>
      <rule>
         <name value="value1"/>
         <source>
            <context value="cda"/>
            <element value="effectiveTime"/>
            <variable value="effectiveTime"/>
            <condition value="(value.exists())"/>
         </source>
         <target>
            <context value="ob"/>
            <contextType value="variable"/>
            <element value="effective"/>
            <variable value="value"/>
            <transform value="create"/>
            <parameter>
               <valueString value="dateTime"/>
            </parameter>
         </target>
         <dependent>
            <name value="TSDateTime"/>
            <variable value="effectiveTime">
               <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                  <valueUrl value="id"/>
               </extension>
            </variable>
            <variable value="value">
               <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                  <valueUrl value="id"/>
               </extension>
            </variable>
         </dependent>
      </rule>
      <rule>
         <name value="valuePeriod"/>
         <source>
            <context value="cda"/>
            <element value="effectiveTime"/>
            <variable value="effectiveTime"/>
            <condition value="(low.exists())"/>
         </source>
         <target>
            <context value="ob"/>
            <contextType value="variable"/>
            <element value="effective"/>
            <variable value="value"/>
            <transform value="create"/>
            <parameter>
               <valueString value="Period"/>
            </parameter>
         </target>
         <dependent>
            <name value="IVLTSPeriod"/>
            <variable value="effectiveTime">
               <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                  <valueUrl value="id"/>
               </extension>
            </variable>
            <variable value="value">
               <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                  <valueUrl value="id"/>
               </extension>
            </variable>
         </dependent>
      </rule>
      <rule>
         <name value="note"/>
         <source>
            <context value="cda"/>
            <element value="text"/>
            <variable value="text"/>
         </source>
         <target>
            <context value="ob"/>
            <contextType value="variable"/>
            <element value="note"/>
            <variable value="note"/>
         </target>
         <rule>
            <name value="text"/>
            <source>
               <context value="text"/>
               <element value="reference"/>
               <variable value="reference"/>
            </source>
            <target>
               <context value="note"/>
               <contextType value="variable"/>
               <element value="text"/>
               <transform value="evaluate"/>
               <parameter>
                  <valueString value="reference.value"/>
               </parameter>
            </target>
         </rule>
      </rule>
      <rule>
         <name value="status"/>
         <source>
            <context value="cda"/>
            <element value="statusCode"/>
            <variable value="s"/>
         </source>
         <rule>
            <name value="codeS"/>
            <source>
               <context value="s"/>
               <element value="code"/>
               <variable value="cos"/>
            </source>
            <target>
               <context value="ob"/>
               <contextType value="variable"/>
               <element value="status"/>
               <transform value="translate"/>
               <parameter>
                  <valueId value="cos"/>
               </parameter>
               <parameter>
                  <valueString value="#OBSstatus"/>
               </parameter>
               <parameter>
                  <valueString value="code"/>
               </parameter>
            </target>
         </rule>
      </rule>
   </group>
   <group>
      <name value="ImagingStudy"/>
      <typeMode value="none"/>
      <input>
         <name value="src"/>
         <type value="act"/>
         <mode value="source"/>
      </input>
      <input>
         <name value="section"/>
         <type value="section"/>
         <mode value="source"/>
      </input>
      <input>
         <name value="tgt"/>
         <type value="ImagingStudy"/>
         <mode value="target"/>
      </input>
      <input>
         <name value="patient"/>
         <type value="patient"/>
         <mode value="target"/>
      </input>
      <input>
         <name value="encounter"/>
         <type value="encounter"/>
         <mode value="target"/>
      </input>
      <rule>
         <name value="id"/>
         <source>
            <context value="src"/>
            <element value="id"/>
            <variable value="vvv"/>
         </source>
         <target>
            <context value="tgt"/>
            <contextType value="variable"/>
            <element value="identifier"/>
            <variable value="vvv"/>
            <transform value="create"/>
         </target>
      </rule>
      <rule>
         <name value="reference"/>
         <source>
            <context value="src"/>
         </source>
         <target>
            <context value="tgt"/>
            <contextType value="variable"/>
            <element value="subject"/>
            <variable value="reference"/>
            <transform value="create"/>
            <parameter>
               <valueString value="Reference"/>
            </parameter>
         </target>
         <target>
            <context value="reference"/>
            <contextType value="variable"/>
            <element value="reference"/>
            <transform value="evaluate"/>
            <parameter>
               <valueString value="'https://example/Patient/' + %patient.id"/>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="reference"/>
         <source>
            <context value="src"/>
         </source>
         <target>
            <context value="tgt"/>
            <contextType value="variable"/>
            <element value="encounter"/>
            <variable value="reference"/>
            <transform value="create"/>
            <parameter>
               <valueString value="Reference"/>
            </parameter>
         </target>
         <target>
            <context value="reference"/>
            <contextType value="variable"/>
            <element value="reference"/>
            <transform value="evaluate"/>
            <parameter>
               <valueString value="'https://example/Encounter/' + %encounter.id"/>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="status"/>
         <source>
            <context value="src"/>
         </source>
         <target>
            <context value="tgt"/>
            <contextType value="variable"/>
            <element value="status"/>
            <transform value="copy"/>
            <parameter>
               <valueString value="available"/>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="entryRelationship"/>
         <source>
            <context value="src"/>
            <element value="entryRelationship"/>
            <variable value="entryRelationship"/>
         </source>
         <rule>
            <name value="series"/>
            <source>
               <context value="entryRelationship"/>
               <element value="act"/>
               <variable value="act"/>
            </source>
            <target>
               <context value="tgt"/>
               <contextType value="variable"/>
               <element value="series"/>
               <variable value="series"/>
            </target>
            <rule>
               <name value="id"/>
               <source>
                  <context value="act"/>
                  <element value="id"/>
                  <variable value="id"/>
               </source>
               <target>
                  <context value="series"/>
                  <contextType value="variable"/>
                  <element value="uid"/>
                  <transform value="evaluate"/>
                  <parameter>
                     <valueString value="id.root"/>
                  </parameter>
               </target>
            </rule>
            <rule>
               <name value="modality"/>
               <source>
                  <context value="section"/>
                  <element value="code"/>
                  <variable value="code"/>
               </source>
               <target>
                  <context value="series"/>
                  <contextType value="variable"/>
                  <element value="modality"/>
                  <variable value="coding"/>
                  <transform value="create"/>
                  <parameter>
                     <valueString value="Coding"/>
                  </parameter>
               </target>
               <rule>
                  <name value="code"/>
                  <source>
                     <context value="code"/>
                     <element value="code"/>
                     <variable value="code1"/>
                  </source>
                  <target>
                     <context value="coding"/>
                     <contextType value="variable"/>
                     <element value="code"/>
                     <transform value="cast"/>
                     <parameter>
                        <valueId value="code1"/>
                     </parameter>
                     <parameter>
                        <valueString value="string"/>
                     </parameter>
                  </target>
               </rule>
               <rule>
                  <name value="codeSystem"/>
                  <source>
                     <context value="code"/>
                     <element value="codeSystem"/>
                     <variable value="system"/>
                  </source>
                  <target>
                     <context value="coding"/>
                     <contextType value="variable"/>
                     <element value="system"/>
                     <transform value="translate"/>
                     <parameter>
                        <valueId value="system"/>
                     </parameter>
                     <parameter>
                        <valueString value="http://hl7.org/fhir/ConceptMap/special-oid2uri"/>
                     </parameter>
                     <parameter>
                        <valueString value="uri"/>
                     </parameter>
                  </target>
               </rule>
               <rule>
                  <name value="displayName"/>
                  <source>
                     <context value="code"/>
                     <element value="displayName"/>
                     <variable value="display"/>
                  </source>
                  <target>
                     <context value="coding"/>
                     <contextType value="variable"/>
                     <element value="display"/>
                     <transform value="cast"/>
                     <parameter>
                        <valueId value="display"/>
                     </parameter>
                     <parameter>
                        <valueString value="string"/>
                     </parameter>
                  </target>
               </rule>
            </rule>
            <rule>
               <name value="instance"/>
               <source>
                  <context value="act"/>
                  <element value="entryRelationship"/>
                  <variable value="entryRelationship2"/>
               </source>
               <rule>
                  <name value="idRoot"/>
                  <source>
                     <context value="entryRelationship2"/>
                     <element value="observation"/>
                     <variable value="obs"/>
                  </source>
                  <target>
                     <context value="series"/>
                     <contextType value="variable"/>
                     <element value="instance"/>
                     <variable value="instance"/>
                  </target>
                  <rule>
                     <name value="root"/>
                     <source>
                        <context value="obs"/>
                        <element value="id"/>
                        <variable value="id"/>
                     </source>
                     <target>
                        <context value="instance"/>
                        <contextType value="variable"/>
                        <element value="uid"/>
                        <transform value="evaluate"/>
                        <parameter>
                           <valueString value="id.root"/>
                        </parameter>
                     </target>
                  </rule>
                  <rule>
                     <name value="sopClass"/>
                     <source>
                        <context value="obs"/>
                        <element value="code"/>
                        <variable value="code1"/>
                     </source>
                     <target>
                        <context value="instance"/>
                        <contextType value="variable"/>
                        <element value="sopClass"/>
                        <variable value="coding"/>
                        <transform value="create"/>
                        <parameter>
                           <valueString value="Coding"/>
                        </parameter>
                     </target>
                     <rule>
                        <name value="code"/>
                        <source>
                           <context value="code1"/>
                           <element value="code"/>
                           <variable value="code"/>
                        </source>
                        <target>
                           <context value="coding"/>
                           <contextType value="variable"/>
                           <element value="code"/>
                           <transform value="cast"/>
                           <parameter>
                              <valueId value="code"/>
                           </parameter>
                           <parameter>
                              <valueString value="string"/>
                           </parameter>
                        </target>
                     </rule>
                     <rule>
                        <name value="codeSystem"/>
                        <source>
                           <context value="code1"/>
                           <element value="codeSystem"/>
                           <variable value="system"/>
                        </source>
                        <target>
                           <context value="coding"/>
                           <contextType value="variable"/>
                           <element value="system"/>
                           <transform value="translate"/>
                           <parameter>
                              <valueId value="system"/>
                           </parameter>
                           <parameter>
                              <valueString value="http://hl7.org/fhir/ConceptMap/special-oid2uri"/>
                           </parameter>
                           <parameter>
                              <valueString value="uri"/>
                           </parameter>
                        </target>
                     </rule>
                     <rule>
                        <name value="displayName"/>
                        <source>
                           <context value="code1"/>
                           <element value="displayName"/>
                           <variable value="display"/>
                        </source>
                        <target>
                           <context value="coding"/>
                           <contextType value="variable"/>
                           <element value="display"/>
                           <transform value="cast"/>
                           <parameter>
                              <valueId value="display"/>
                           </parameter>
                           <parameter>
                              <valueString value="string"/>
                           </parameter>
                        </target>
                     </rule>
                  </rule>
               </rule>
            </rule>
         </rule>
      </rule>
   </group>
   <group>
      <name value="ConditionFunction"/>
      <typeMode value="none"/>
      <input>
         <name value="src"/>
         <type value="cdaElement"/>
         <mode value="source"/>
      </input>
      <input>
         <name value="tgt"/>
         <type value="Condition"/>
         <mode value="target"/>
      </input>
      <input>
         <name value="patient"/>
         <type value="patient"/>
         <mode value="target"/>
      </input>
      <input>
         <name value="encounter"/>
         <type value="encounter"/>
         <mode value="target"/>
      </input>
      <input>
         <name value="bundle"/>
         <type value="Bundle"/>
         <mode value="target"/>
      </input>
      <rule>
         <name value="code"/>
         <source>
            <context value="src"/>
            <element value="code"/>
            <variable value="vvv"/>
         </source>
         <target>
            <context value="tgt"/>
            <contextType value="variable"/>
            <element value="category"/>
            <variable value="vvv"/>
            <transform value="create"/>
         </target>
      </rule>
      <rule>
         <name value="reference"/>
         <source>
            <context value="src"/>
         </source>
         <target>
            <context value="tgt"/>
            <contextType value="variable"/>
            <element value="subject"/>
            <variable value="reference"/>
            <transform value="create"/>
            <parameter>
               <valueString value="Reference"/>
            </parameter>
         </target>
         <target>
            <context value="reference"/>
            <contextType value="variable"/>
            <element value="reference"/>
            <transform value="evaluate"/>
            <parameter>
               <valueString value="'https://example/Patient/' + %patient.id"/>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="reference"/>
         <source>
            <context value="src"/>
         </source>
         <target>
            <context value="tgt"/>
            <contextType value="variable"/>
            <element value="encounter"/>
            <variable value="reference"/>
            <transform value="create"/>
            <parameter>
               <valueString value="Reference"/>
            </parameter>
         </target>
         <target>
            <context value="reference"/>
            <contextType value="variable"/>
            <element value="reference"/>
            <transform value="evaluate"/>
            <parameter>
               <valueString value="'https://example/Encounter/' + %encounter.id"/>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="verifstatus"/>
         <source>
            <context value="src"/>
            <element value="statusCode"/>
            <variable value="stscode"/>
         </source>
         <target>
            <context value="tgt"/>
            <contextType value="variable"/>
            <element value="verificationStatus"/>
            <variable value="verifstatus"/>
         </target>
         <rule>
            <name value="coding"/>
            <source>
               <context value="stscode"/>
               <variable value="codeS"/>
            </source>
            <target>
               <context value="verifstatus"/>
               <contextType value="variable"/>
               <element value="coding"/>
               <variable value="coding"/>
               <transform value="create"/>
               <parameter>
                  <valueString value="Coding"/>
               </parameter>
            </target>
            <rule>
               <name value="code"/>
               <source>
                  <context value="codeS"/>
                  <element value="code"/>
               </source>
               <target>
                  <context value="coding"/>
                  <contextType value="variable"/>
                  <element value="code"/>
                  <transform value="copy"/>
                  <parameter>
                     <valueString value="confirmed"/>
                  </parameter>
               </target>
            </rule>
            <rule>
               <name value="system"/>
               <source>
                  <context value="codeS"/>
               </source>
               <target>
                  <context value="coding"/>
                  <contextType value="variable"/>
                  <element value="system"/>
                  <transform value="copy"/>
                  <parameter>
                     <valueString value="http://terminology.hl7.org/CodeSystem/condition-ver-status"/>
                  </parameter>
               </target>
            </rule>
            <rule>
               <name value="display"/>
               <source>
                  <context value="codeS"/>
               </source>
               <target>
                  <context value="coding"/>
                  <contextType value="variable"/>
                  <element value="display"/>
                  <transform value="cast"/>
                  <parameter>
                     <valueString value="Confirmed"/>
                  </parameter>
                  <parameter>
                     <valueString value="string"/>
                  </parameter>
               </target>
            </rule>
         </rule>
      </rule>
      <rule>
         <name value="valuePeriod"/>
         <source>
            <context value="src"/>
            <element value="effectiveTime"/>
            <variable value="effectiveTime"/>
         </source>
         <target>
            <context value="tgt"/>
            <contextType value="variable"/>
            <element value="onset"/>
            <variable value="value"/>
            <transform value="create"/>
            <parameter>
               <valueString value="Period"/>
            </parameter>
         </target>
         <dependent>
            <name value="IVLTSPeriod"/>
            <variable value="effectiveTime">
               <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                  <valueUrl value="id"/>
               </extension>
            </variable>
            <variable value="value">
               <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                  <valueUrl value="id"/>
               </extension>
            </variable>
         </dependent>
      </rule>
      <rule>
         <name value="value"/>
         <source>
            <context value="src"/>
            <element value="value"/>
            <variable value="vvv"/>
         </source>
         <target>
            <context value="tgt"/>
            <contextType value="variable"/>
            <element value="code"/>
            <variable value="vvv"/>
            <transform value="create"/>
         </target>
      </rule>
      <rule>
         <name value="entryR"/>
         <source>
            <context value="src"/>
            <element value="entryRelationship"/>
            <variable value="entryRelationship"/>
         </source>
         <rule>
            <name value="EntryRelObsevation"/>
            <source>
               <context value="entryRelationship"/>
               <element value="observation"/>
               <variable value="obsentry"/>
            </source>
            <rule>
               <name value="observation"/>
               <source>
                  <context value="obsentry"/>
                  <element value="code"/>
                  <condition value="code = '89261-2'"/>
               </source>
               <rule>
                  <name value="observation"/>
                  <source>
                     <context value="obsentry"/>
                  </source>
                  <target>
                     <context value="tgt"/>
                     <contextType value="variable"/>
                     <element value="evidence"/>
                     <variable value="evidence"/>
                  </target>
                  <target>
                     <context value="bundle"/>
                     <contextType value="variable"/>
                     <element value="entry"/>
                     <variable value="e1"/>
                  </target>
                  <target>
                     <context value="e1"/>
                     <contextType value="variable"/>
                     <element value="request"/>
                     <variable value="request"/>
                     <transform value="create"/>
                     <parameter>
                        <valueString value="BackboneElement"/>
                     </parameter>
                  </target>
                  <target>
                     <context value="request"/>
                     <contextType value="variable"/>
                     <element value="method"/>
                     <transform value="copy"/>
                     <parameter>
                        <valueString value="POST"/>
                     </parameter>
                  </target>
                  <target>
                     <context value="e1"/>
                     <contextType value="variable"/>
                     <element value="resource"/>
                     <variable value="obsy"/>
                     <transform value="create"/>
                     <parameter>
                        <valueString value="Observation"/>
                     </parameter>
                  </target>
                  <target>
                     <context value="obsy"/>
                     <contextType value="variable"/>
                     <element value="id"/>
                     <variable value="uuid1"/>
                     <transform value="uuid"/>
                  </target>
                  <target>
                     <context value="e1"/>
                     <contextType value="variable"/>
                     <element value="fullUrl"/>
                     <transform value="append"/>
                     <parameter>
                        <valueString value="https://example/Observation/"/>
                     </parameter>
                     <parameter>
                        <valueId value="uuid1"/>
                     </parameter>
                  </target>
                  <target>
                     <context value="request"/>
                     <contextType value="variable"/>
                     <element value="url"/>
                     <transform value="copy"/>
                     <parameter>
                        <valueString value="Observation"/>
                     </parameter>
                  </target>
                  <target>
                     <context value="evidence"/>
                     <contextType value="variable"/>
                     <element value="detail"/>
                     <variable value="reference"/>
                     <transform value="create"/>
                     <parameter>
                        <valueString value="Reference"/>
                     </parameter>
                  </target>
                  <target>
                     <context value="reference"/>
                     <contextType value="variable"/>
                     <element value="reference"/>
                     <transform value="evaluate"/>
                     <parameter>
                        <valueString value="'https://example/Observation/' + %obsy.id"/>
                     </parameter>
                  </target>
                  <dependent>
                     <name value="Observation"/>
                     <variable value="obsentry">
                        <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                           <valueUrl value="id"/>
                        </extension>
                     </variable>
                     <variable value="patient">
                        <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                           <valueUrl value="id"/>
                        </extension>
                     </variable>
                     <variable value="encounter">
                        <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                           <valueUrl value="id"/>
                        </extension>
                     </variable>
                     <variable value="obsy">
                        <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                           <valueUrl value="id"/>
                        </extension>
                     </variable>
                     <variable value="bundle">
                        <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                           <valueUrl value="id"/>
                        </extension>
                     </variable>
                  </dependent>
               </rule>
            </rule>
            <rule>
               <name value="clinicalStatus2"/>
               <source>
                  <context value="obsentry"/>
                  <element value="code"/>
                  <condition value="code = '33999-4'"/>
               </source>
               <rule>
                  <name value="clinicalstatus"/>
                  <source>
                     <context value="obsentry"/>
                     <element value="value"/>
                     <variable value="value"/>
                  </source>
                  <target>
                     <context value="tgt"/>
                     <contextType value="variable"/>
                     <element value="clinicalStatus"/>
                     <variable value="clinicalstatus"/>
                  </target>
                  <rule>
                     <name value="coding"/>
                     <source>
                        <context value="value"/>
                        <variable value="val"/>
                     </source>
                     <target>
                        <context value="clinicalstatus"/>
                        <contextType value="variable"/>
                        <element value="coding"/>
                        <variable value="coding"/>
                        <transform value="create"/>
                        <parameter>
                           <valueString value="Coding"/>
                        </parameter>
                     </target>
                     <rule>
                        <name value="code"/>
                        <source>
                           <context value="val"/>
                           <condition value="(code = 'LA9041-0')"/>
                        </source>
                        <target>
                           <context value="coding"/>
                           <contextType value="variable"/>
                           <element value="code"/>
                           <transform value="copy"/>
                           <parameter>
                              <valueString value="resolved"/>
                           </parameter>
                        </target>
                     </rule>
                     <rule>
                        <name value="code"/>
                        <source>
                           <context value="val"/>
                           <condition value="(code = 'LA18632-2')"/>
                        </source>
                        <target>
                           <context value="coding"/>
                           <contextType value="variable"/>
                           <element value="code"/>
                           <transform value="copy"/>
                           <parameter>
                              <valueString value="inactive"/>
                           </parameter>
                        </target>
                     </rule>
                     <rule>
                        <name value="code"/>
                        <source>
                           <context value="val"/>
                           <condition value="(code = 'LA16666-2')"/>
                        </source>
                        <target>
                           <context value="coding"/>
                           <contextType value="variable"/>
                           <element value="code"/>
                           <transform value="copy"/>
                           <parameter>
                              <valueString value="active"/>
                           </parameter>
                        </target>
                     </rule>
                     <rule>
                        <name value="system"/>
                        <source>
                           <context value="val"/>
                        </source>
                        <target>
                           <context value="coding"/>
                           <contextType value="variable"/>
                           <element value="system"/>
                           <transform value="copy"/>
                           <parameter>
                              <valueString value="http://terminology.hl7.org/CodeSystem/condition-clinical"/>
                           </parameter>
                        </target>
                     </rule>
                     <rule>
                        <name value="display"/>
                        <source>
                           <context value="val"/>
                           <element value="displayName"/>
                           <variable value="display"/>
                        </source>
                        <target>
                           <context value="coding"/>
                           <contextType value="variable"/>
                           <element value="display"/>
                           <transform value="cast"/>
                           <parameter>
                              <valueId value="display"/>
                           </parameter>
                           <parameter>
                              <valueString value="string"/>
                           </parameter>
                        </target>
                     </rule>
                  </rule>
                  <rule>
                     <name value="text"/>
                     <source>
                        <context value="obsentry"/>
                        <element value="text"/>
                        <variable value="text"/>
                     </source>
                     <rule>
                        <name value="text"/>
                        <source>
                           <context value="text"/>
                           <element value="reference"/>
                           <variable value="reference"/>
                        </source>
                        <target>
                           <context value="clinicalstatus"/>
                           <contextType value="variable"/>
                           <element value="text"/>
                           <transform value="evaluate"/>
                           <parameter>
                              <valueString value="reference.value"/>
                           </parameter>
                        </target>
                     </rule>
                  </rule>
               </rule>
            </rule>
         </rule>
      </rule>
   </group>
   <group>
      <name value="allergyFunction"/>
      <typeMode value="none"/>
      <input>
         <name value="src"/>
         <type value="cdaElement"/>
         <mode value="source"/>
      </input>
      <input>
         <name value="tgt"/>
         <type value="AllergyIntolerance"/>
         <mode value="target"/>
      </input>
      <input>
         <name value="patient"/>
         <type value="patient"/>
         <mode value="target"/>
      </input>
      <input>
         <name value="encounter"/>
         <type value="encounter"/>
         <mode value="target"/>
      </input>
      <rule>
         <name value="reference"/>
         <source>
            <context value="src"/>
         </source>
         <target>
            <context value="tgt"/>
            <contextType value="variable"/>
            <element value="patient"/>
            <variable value="reference"/>
            <transform value="create"/>
            <parameter>
               <valueString value="Reference"/>
            </parameter>
         </target>
         <target>
            <context value="reference"/>
            <contextType value="variable"/>
            <element value="reference"/>
            <transform value="evaluate"/>
            <parameter>
               <valueString value="'https://example/Patient/' + %patient.id"/>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="reference"/>
         <source>
            <context value="src"/>
         </source>
         <target>
            <context value="tgt"/>
            <contextType value="variable"/>
            <element value="encounter"/>
            <variable value="reference"/>
            <transform value="create"/>
            <parameter>
               <valueString value="Reference"/>
            </parameter>
         </target>
         <target>
            <context value="reference"/>
            <contextType value="variable"/>
            <element value="reference"/>
            <transform value="evaluate"/>
            <parameter>
               <valueString value="'https://example/Encounter/' + %encounter.id"/>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="entryrelationship"/>
         <source>
            <context value="src"/>
            <element value="entryRelationship"/>
            <variable value="entryRelationship1"/>
         </source>
         <rule>
            <name value="observation"/>
            <source>
               <context value="entryRelationship1"/>
               <element value="observation"/>
               <variable value="observation1"/>
            </source>
            <rule>
               <name value="valuePeriod"/>
               <source>
                  <context value="observation1"/>
                  <element value="effectiveTime"/>
                  <variable value="effectiveTime"/>
               </source>
               <target>
                  <context value="tgt"/>
                  <contextType value="variable"/>
                  <element value="onset"/>
                  <variable value="value"/>
                  <transform value="create"/>
                  <parameter>
                     <valueString value="Period"/>
                  </parameter>
               </target>
               <dependent>
                  <name value="IVLTSPeriod"/>
                  <variable value="effectiveTime">
                     <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                        <valueUrl value="id"/>
                     </extension>
                  </variable>
                  <variable value="value">
                     <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                        <valueUrl value="id"/>
                     </extension>
                  </variable>
               </dependent>
            </rule>
            <rule>
               <name value="code"/>
               <source>
                  <context value="observation1"/>
                  <element value="value"/>
                  <variable value="code"/>
               </source>
               <rule>
                  <name value="type"/>
                  <source>
                     <context value="code"/>
                     <element value="code"/>
                     <variable value="code1"/>
                  </source>
                  <target>
                     <context value="tgt"/>
                     <contextType value="variable"/>
                     <element value="type"/>
                     <transform value="translate"/>
                     <parameter>
                        <valueId value="code1"/>
                     </parameter>
                     <parameter>
                        <valueString value="#AllergyTypeMap"/>
                     </parameter>
                     <parameter>
                        <valueString value="code"/>
                     </parameter>
                  </target>
               </rule>
               <rule>
                  <name value="category"/>
                  <source>
                     <context value="code"/>
                     <element value="code"/>
                     <variable value="code1"/>
                  </source>
                  <target>
                     <context value="tgt"/>
                     <contextType value="variable"/>
                     <element value="category"/>
                     <transform value="translate"/>
                     <parameter>
                        <valueId value="code1"/>
                     </parameter>
                     <parameter>
                        <valueString value="#AllergyCategoryMap"/>
                     </parameter>
                     <parameter>
                        <valueString value="code"/>
                     </parameter>
                  </target>
               </rule>
            </rule>
            <rule>
               <name value="participant"/>
               <source>
                  <context value="observation1"/>
                  <element value="participant"/>
                  <variable value="participant"/>
               </source>
               <target>
                  <context value="tgt"/>
                  <contextType value="variable"/>
                  <element value="reaction"/>
                  <variable value="reaction"/>
               </target>
               <rule>
                  <name value="entryR2"/>
                  <source>
                     <context value="observation1"/>
                     <element value="entryRelationship"/>
                     <variable value="entryRelationship2"/>
                     <condition value="(typeCode = 'MFST')"/>
                  </source>
                  <rule>
                     <name value="observ2"/>
                     <source>
                        <context value="entryRelationship2"/>
                        <element value="observation"/>
                        <variable value="observation2"/>
                     </source>
                     <rule>
                        <name value="manifestation"/>
                        <source>
                           <context value="observation2"/>
                           <element value="value"/>
                           <variable value="vvv"/>
                        </source>
                        <target>
                           <context value="reaction"/>
                           <contextType value="variable"/>
                           <element value="manifestation"/>
                           <variable value="vvv"/>
                           <transform value="create"/>
                        </target>
                     </rule>
                     <rule>
                        <name value="low"/>
                        <source>
                           <context value="observation2"/>
                           <element value="effectiveTime"/>
                           <variable value="effectiveTime"/>
                        </source>
                        <rule>
                           <name value="valuePeriodLow"/>
                           <source>
                              <context value="effectiveTime"/>
                              <element value="low"/>
                              <variable value="low"/>
                           </source>
                           <target>
                              <context value="reaction"/>
                              <contextType value="variable"/>
                              <element value="onset"/>
                              <variable value="value"/>
                              <transform value="create"/>
                              <parameter>
                                 <valueString value="dateTime"/>
                              </parameter>
                           </target>
                           <dependent>
                              <name value="TSDateTime"/>
                              <variable value="low">
                                 <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                                    <valueUrl value="id"/>
                                 </extension>
                              </variable>
                              <variable value="value">
                                 <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                                    <valueUrl value="id"/>
                                 </extension>
                              </variable>
                           </dependent>
                        </rule>
                     </rule>
                  </rule>
               </rule>
               <rule>
                  <name value="participantRole"/>
                  <source>
                     <context value="participant"/>
                     <element value="participantRole"/>
                     <variable value="participantRole"/>
                  </source>
                  <rule>
                     <name value="playingEntity"/>
                     <source>
                        <context value="participantRole"/>
                        <element value="playingEntity"/>
                        <variable value="playingEntity"/>
                     </source>
                     <rule>
                        <name value="reaction"/>
                        <source>
                           <context value="playingEntity"/>
                           <element value="code"/>
                           <variable value="vvv"/>
                        </source>
                        <target>
                           <context value="reaction"/>
                           <contextType value="variable"/>
                           <element value="substance"/>
                           <variable value="vvv"/>
                           <transform value="create"/>
                        </target>
                     </rule>
                  </rule>
               </rule>
            </rule>
            <rule>
               <name value="entryR2"/>
               <source>
                  <context value="observation1"/>
                  <element value="entryRelationship"/>
                  <variable value="entryRelationship2"/>
                  <condition value="(typeCode = 'MFST')"/>
               </source>
               <rule>
                  <name value="observ2"/>
                  <source>
                     <context value="entryRelationship2"/>
                     <element value="observation"/>
                     <variable value="observation2"/>
                     <condition value="observation1.participant.exists().not()"/>
                  </source>
                  <target>
                     <context value="tgt"/>
                     <contextType value="variable"/>
                     <element value="reaction"/>
                     <variable value="reaction"/>
                  </target>
                  <rule>
                     <name value="manifestation"/>
                     <source>
                        <context value="observation2"/>
                        <element value="value"/>
                        <variable value="vvv"/>
                     </source>
                     <target>
                        <context value="reaction"/>
                        <contextType value="variable"/>
                        <element value="manifestation"/>
                        <variable value="vvv"/>
                        <transform value="create"/>
                     </target>
                  </rule>
                  <rule>
                     <name value="low"/>
                     <source>
                        <context value="observation2"/>
                        <element value="effectiveTime"/>
                        <variable value="effectiveTime"/>
                     </source>
                     <rule>
                        <name value="valuePeriodLow"/>
                        <source>
                           <context value="effectiveTime"/>
                           <element value="low"/>
                           <variable value="low"/>
                        </source>
                        <target>
                           <context value="reaction"/>
                           <contextType value="variable"/>
                           <element value="onset"/>
                           <variable value="value"/>
                           <transform value="create"/>
                           <parameter>
                              <valueString value="dateTime"/>
                           </parameter>
                        </target>
                        <dependent>
                           <name value="TSDateTime"/>
                           <variable value="low">
                              <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                                 <valueUrl value="id"/>
                              </extension>
                           </variable>
                           <variable value="value">
                              <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                                 <valueUrl value="id"/>
                              </extension>
                           </variable>
                        </dependent>
                     </rule>
                  </rule>
               </rule>
            </rule>
            <rule>
               <name value="entryR3"/>
               <source>
                  <context value="observation1"/>
                  <element value="entryRelationship"/>
                  <variable value="entryRelationship3"/>
                  <condition value="(typeCode = 'SUBJ')"/>
               </source>
               <rule>
                  <name value="observ3"/>
                  <source>
                     <context value="entryRelationship3"/>
                     <element value="observation"/>
                     <variable value="observation3"/>
                  </source>
                  <rule>
                     <name value="criticality"/>
                     <source>
                        <context value="observation3"/>
                        <element value="value"/>
                        <variable value="value"/>
                     </source>
                     <rule>
                        <name value="value"/>
                        <source>
                           <context value="value"/>
                           <element value="code"/>
                           <variable value="c"/>
                        </source>
                        <target>
                           <context value="tgt"/>
                           <contextType value="variable"/>
                           <element value="criticality"/>
                           <transform value="translate"/>
                           <parameter>
                              <valueId value="c"/>
                           </parameter>
                           <parameter>
                              <valueString value="#CricalityMap"/>
                           </parameter>
                           <parameter>
                              <valueString value="code"/>
                           </parameter>
                        </target>
                     </rule>
                     <documentation value="criticality"/>
                  </rule>
               </rule>
               <rule>
                  <name value="act"/>
                  <source>
                     <context value="entryRelationship3"/>
                     <element value="act"/>
                     <variable value="act"/>
                  </source>
                  <target>
                     <context value="tgt"/>
                     <contextType value="variable"/>
                     <element value="note"/>
                     <variable value="note"/>
                  </target>
                  <rule>
                     <name value="note"/>
                     <source>
                        <context value="act"/>
                        <element value="text"/>
                        <variable value="text"/>
                     </source>
                     <rule>
                        <name value="reference"/>
                        <source>
                           <context value="text"/>
                           <element value="reference"/>
                           <variable value="reference"/>
                        </source>
                        <target>
                           <context value="note"/>
                           <contextType value="variable"/>
                           <element value="text"/>
                           <transform value="evaluate"/>
                           <parameter>
                              <valueString value="reference.value"/>
                           </parameter>
                        </target>
                     </rule>
                  </rule>
               </rule>
            </rule>
            <rule>
               <name value="entryR4"/>
               <source>
                  <context value="observation1"/>
                  <element value="entryRelationship"/>
                  <variable value="entryRelationship4"/>
                  <condition value="(typeCode = 'REFR')"/>
               </source>
               <rule>
                  <name value="observ4"/>
                  <source>
                     <context value="entryRelationship4"/>
                     <element value="observation"/>
                     <variable value="observation4"/>
                  </source>
                  <rule>
                     <name value="clinicalStatus"/>
                     <source>
                        <context value="observation4"/>
                        <element value="value"/>
                        <variable value="value"/>
                     </source>
                     <target>
                        <context value="tgt"/>
                        <contextType value="variable"/>
                        <element value="clinicalStatus"/>
                        <variable value="clinicalStatus"/>
                     </target>
                     <rule>
                        <name value="coding"/>
                        <source>
                           <context value="value"/>
                           <variable value="valu"/>
                        </source>
                        <target>
                           <context value="clinicalStatus"/>
                           <contextType value="variable"/>
                           <element value="coding"/>
                           <variable value="coding"/>
                           <transform value="create"/>
                           <parameter>
                              <valueString value="Coding"/>
                           </parameter>
                        </target>
                        <rule>
                           <name value="code"/>
                           <source>
                              <context value="valu"/>
                              <condition value="(code = 'LA9041-0')"/>
                           </source>
                           <target>
                              <context value="coding"/>
                              <contextType value="variable"/>
                              <element value="code"/>
                              <transform value="copy"/>
                              <parameter>
                                 <valueString value="resolved"/>
                              </parameter>
                           </target>
                        </rule>
                        <rule>
                           <name value="code"/>
                           <source>
                              <context value="valu"/>
                              <condition value="(code = 'LA18632-2')"/>
                           </source>
                           <target>
                              <context value="coding"/>
                              <contextType value="variable"/>
                              <element value="code"/>
                              <transform value="copy"/>
                              <parameter>
                                 <valueString value="inactive"/>
                              </parameter>
                           </target>
                        </rule>
                        <rule>
                           <name value="code"/>
                           <source>
                              <context value="valu"/>
                              <condition value="(code = 'LA16666-2')"/>
                           </source>
                           <target>
                              <context value="coding"/>
                              <contextType value="variable"/>
                              <element value="code"/>
                              <transform value="copy"/>
                              <parameter>
                                 <valueString value="active"/>
                              </parameter>
                           </target>
                        </rule>
                        <rule>
                           <name value="system"/>
                           <source>
                              <context value="valu"/>
                           </source>
                           <target>
                              <context value="coding"/>
                              <contextType value="variable"/>
                              <element value="system"/>
                              <transform value="copy"/>
                              <parameter>
                                 <valueString value="http://terminology.hl7.org/CodeSystem/allergyintolerance-clinical"/>
                              </parameter>
                           </target>
                        </rule>
                        <rule>
                           <name value="display"/>
                           <source>
                              <context value="valu"/>
                              <element value="displayName"/>
                              <variable value="display"/>
                           </source>
                           <target>
                              <context value="coding"/>
                              <contextType value="variable"/>
                              <element value="display"/>
                              <transform value="cast"/>
                              <parameter>
                                 <valueId value="display"/>
                              </parameter>
                              <parameter>
                                 <valueString value="string"/>
                              </parameter>
                           </target>
                        </rule>
                     </rule>
                     <documentation value="observation4.value -> tgt.clinicalStatus;"/>
                  </rule>
               </rule>
            </rule>
         </rule>
      </rule>
   </group>
   <group>
      <name value="FamilyMemberFunction"/>
      <typeMode value="none"/>
      <input>
         <name value="src"/>
         <type value="organizer"/>
         <mode value="source"/>
      </input>
      <input>
         <name value="tgt"/>
         <type value="familyMember"/>
         <mode value="target"/>
      </input>
      <input>
         <name value="patient"/>
         <type value="patient"/>
         <mode value="target"/>
      </input>
      <rule>
         <name value="patReference"/>
         <source>
            <context value="src"/>
         </source>
         <target>
            <context value="tgt"/>
            <contextType value="variable"/>
            <element value="patient"/>
            <variable value="reference"/>
            <transform value="create"/>
            <parameter>
               <valueString value="Reference"/>
            </parameter>
         </target>
         <target>
            <context value="reference"/>
            <contextType value="variable"/>
            <element value="reference"/>
            <transform value="evaluate"/>
            <parameter>
               <valueString value="'https://example/Patient/' + %patient.id"/>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="statusCode"/>
         <source>
            <context value="src"/>
            <element value="statusCode"/>
            <variable value="vvv"/>
         </source>
         <target>
            <context value="tgt"/>
            <contextType value="variable"/>
            <element value="status"/>
            <variable value="vvv"/>
            <transform value="create"/>
         </target>
      </rule>
      <rule>
         <name value="date"/>
         <source>
            <context value="src"/>
            <element value="effectiveTime"/>
            <variable value="effectiveTime"/>
         </source>
         <target>
            <context value="tgt"/>
            <contextType value="variable"/>
            <element value="date"/>
            <variable value="value"/>
            <transform value="create"/>
            <parameter>
               <valueString value="date"/>
            </parameter>
         </target>
         <dependent>
            <name value="TSDate"/>
            <variable value="effectiveTime">
               <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                  <valueUrl value="id"/>
               </extension>
            </variable>
            <variable value="value">
               <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                  <valueUrl value="id"/>
               </extension>
            </variable>
         </dependent>
      </rule>
      <rule>
         <name value="relationship"/>
         <source>
            <context value="src"/>
            <element value="subject"/>
            <variable value="subject"/>
         </source>
         <rule>
            <name value="relatedSub"/>
            <source>
               <context value="subject"/>
               <element value="relatedSubject"/>
               <variable value="relatedSubject"/>
            </source>
            <rule>
               <name value="relationship code"/>
               <source>
                  <context value="relatedSubject"/>
                  <element value="code"/>
                  <variable value="vvv"/>
               </source>
               <target>
                  <context value="tgt"/>
                  <contextType value="variable"/>
                  <element value="relationship"/>
                  <variable value="vvv"/>
                  <transform value="create"/>
               </target>
            </rule>
            <rule>
               <name value="subject"/>
               <source>
                  <context value="relatedSubject"/>
                  <element value="subject"/>
                  <variable value="subject"/>
               </source>
               <target>
                  <context value="tgt"/>
                  <contextType value="variable"/>
                  <element value="sex"/>
                  <variable value="sex"/>
               </target>
               <rule>
                  <name value="coding"/>
                  <source>
                     <context value="subject"/>
                     <element value="administrativeGenderCode"/>
                     <variable value="administrativeGenderCode"/>
                  </source>
                  <target>
                     <context value="sex"/>
                     <contextType value="variable"/>
                     <element value="coding"/>
                     <variable value="coding"/>
                  </target>
                  <rule>
                     <name value="gender"/>
                     <source>
                        <context value="administrativeGenderCode"/>
                        <element value="code"/>
                        <variable value="sexCode"/>
                     </source>
                     <target>
                        <context value="coding"/>
                        <contextType value="variable"/>
                        <element value="code"/>
                        <transform value="translate"/>
                        <parameter>
                           <valueId value="sexCode"/>
                        </parameter>
                        <parameter>
                           <valueString value="#cm-v3-administrative-gender"/>
                        </parameter>
                        <parameter>
                           <valueString value="code"/>
                        </parameter>
                     </target>
                  </rule>
                  <rule>
                     <name value="system"/>
                     <source>
                        <context value="administrativeGenderCode"/>
                        <element value="system"/>
                     </source>
                     <target>
                        <context value="coding"/>
                        <contextType value="variable"/>
                        <element value="system"/>
                        <transform value="copy"/>
                        <parameter>
                           <valueString value="http://hl7.org/fhir/administrative-gender"/>
                        </parameter>
                     </target>
                  </rule>
               </rule>
            </rule>
         </rule>
      </rule>
      <rule>
         <name value="component"/>
         <source>
            <context value="src"/>
            <element value="component"/>
            <variable value="component"/>
         </source>
         <target>
            <context value="tgt"/>
            <contextType value="variable"/>
            <element value="condition"/>
            <variable value="condition"/>
         </target>
         <rule>
            <name value="observation"/>
            <source>
               <context value="component"/>
               <element value="observation"/>
               <variable value="observation"/>
            </source>
            <rule>
               <name value="code"/>
               <source>
                  <context value="observation"/>
                  <element value="code"/>
                  <variable value="vvv"/>
               </source>
               <target>
                  <context value="condition"/>
                  <contextType value="variable"/>
                  <element value="code"/>
                  <variable value="vvv"/>
                  <transform value="create"/>
               </target>
            </rule>
            <rule>
               <name value="reference"/>
               <source>
                  <context value="observation"/>
                  <element value="text"/>
                  <variable value="text"/>
               </source>
               <target>
                  <context value="tgt"/>
                  <contextType value="variable"/>
                  <element value="note"/>
                  <variable value="note"/>
               </target>
               <rule>
                  <name value="value"/>
                  <source>
                     <context value="text"/>
                     <element value="reference"/>
                     <variable value="reference"/>
                  </source>
                  <target>
                     <context value="note"/>
                     <contextType value="variable"/>
                     <element value="text"/>
                     <transform value="evaluate"/>
                     <parameter>
                        <valueString value="reference.value"/>
                     </parameter>
                  </target>
               </rule>
            </rule>
            <rule>
               <name value="statusCode"/>
               <source>
                  <context value="observation"/>
                  <element value="statusCode"/>
                  <variable value="vvv"/>
               </source>
               <target>
                  <context value="tgt"/>
                  <contextType value="variable"/>
                  <element value="status"/>
                  <variable value="vvv"/>
                  <transform value="create"/>
               </target>
            </rule>
            <rule>
               <name value="valuePeriod"/>
               <source>
                  <context value="observation"/>
                  <element value="effectiveTime"/>
                  <variable value="effectiveTime"/>
               </source>
               <target>
                  <context value="condition"/>
                  <contextType value="variable"/>
                  <element value="onset"/>
                  <variable value="value"/>
                  <transform value="create"/>
                  <parameter>
                     <valueString value="Period"/>
                  </parameter>
               </target>
               <dependent>
                  <name value="IVLTSPeriod"/>
                  <variable value="effectiveTime">
                     <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                        <valueUrl value="id"/>
                     </extension>
                  </variable>
                  <variable value="value">
                     <extension url="http://hl7.org/fhir/tools/StructureDefinition/original-item-type">
                        <valueUrl value="id"/>
                     </extension>
                  </variable>
               </dependent>
            </rule>
            <rule>
               <name value="codeable"/>
               <source>
                  <context value="observation"/>
                  <element value="value"/>
                  <variable value="vvv"/>
               </source>
               <target>
                  <context value="condition"/>
                  <contextType value="variable"/>
                  <element value="outcome"/>
                  <variable value="vvv"/>
                  <transform value="create"/>
               </target>
            </rule>
            <rule>
               <name value="EntryRel"/>
               <source>
                  <context value="observation"/>
                  <element value="entryRelationship"/>
                  <variable value="entryR"/>
               </source>
               <rule>
                  <name value="obser"/>
                  <source>
                     <context value="entryR"/>
                     <element value="observation"/>
                     <variable value="obs"/>
                  </source>
                  <rule>
                     <name value="insorgenza"/>
                     <source>
                        <context value="obs"/>
                        <condition value="(code.code = '35267-4')"/>
                     </source>
                     <rule>
                        <name value="value"/>
                        <source>
                           <context value="obs"/>
                           <element value="value"/>
                           <variable value="value"/>
                        </source>
                        <target>
                           <context value="condition"/>
                           <contextType value="variable"/>
                           <element value="onset"/>
                           <variable value="Age"/>
                           <transform value="create"/>
                           <parameter>
                              <valueString value="Age"/>
                           </parameter>
                        </target>
                        <rule>
                           <name value="age"/>
                           <source>
                              <context value="value"/>
                              <element value="value"/>
                              <variable value="valueAge"/>
                           </source>
                           <target>
                              <context value="Age"/>
                              <contextType value="variable"/>
                              <element value="value"/>
                              <transform value="copy"/>
                              <parameter>
                                 <valueId value="valueAge"/>
                              </parameter>
                           </target>
                        </rule>
                        <rule>
                           <name value="unit"/>
                           <source>
                              <context value="value"/>
                              <element value="unit"/>
                              <variable value="unit"/>
                           </source>
                           <target>
                              <context value="Age"/>
                              <contextType value="variable"/>
                              <element value="code"/>
                              <transform value="copy"/>
                              <parameter>
                                 <valueId value="unit"/>
                              </parameter>
                           </target>
                        </rule>
                        <rule>
                           <name value="unit"/>
                           <source>
                              <context value="value"/>
                              <element value="unit"/>
                              <variable value="unit"/>
                           </source>
                           <target>
                              <context value="Age"/>
                              <contextType value="variable"/>
                              <element value="unit"/>
                              <transform value="copy"/>
                              <parameter>
                                 <valueId value="unit"/>
                              </parameter>
                           </target>
                        </rule>
                        <rule>
                           <name value="system"/>
                           <source>
                              <context value="value"/>
                           </source>
                           <target>
                              <context value="Age"/>
                              <contextType value="variable"/>
                              <element value="system"/>
                              <transform value="copy"/>
                              <parameter>
                                 <valueString value="http://unitsofmeasure.org"/>
                              </parameter>
                           </target>
                        </rule>
                     </rule>
                  </rule>
                  <rule>
                     <name value="death"/>
                     <source>
                        <context value="obs"/>
                        <condition value="(code.code = '39016-1')"/>
                     </source>
                     <rule>
                        <name value="value"/>
                        <source>
                           <context value="obs"/>
                           <element value="value"/>
                           <variable value="value"/>
                        </source>
                        <target>
                           <context value="tgt"/>
                           <contextType value="variable"/>
                           <element value="deceased"/>
                           <variable value="Age"/>
                           <transform value="create"/>
                           <parameter>
                              <valueString value="Age"/>
                           </parameter>
                        </target>
                        <rule>
                           <name value="age"/>
                           <source>
                              <context value="value"/>
                              <element value="value"/>
                              <variable value="valueAge"/>
                           </source>
                           <target>
                              <context value="Age"/>
                              <contextType value="variable"/>
                              <element value="value"/>
                              <transform value="copy"/>
                              <parameter>
                                 <valueId value="valueAge"/>
                              </parameter>
                           </target>
                        </rule>
                        <rule>
                           <name value="unit"/>
                           <source>
                              <context value="value"/>
                              <element value="unit"/>
                              <variable value="unit"/>
                           </source>
                           <target>
                              <context value="Age"/>
                              <contextType value="variable"/>
                              <element value="code"/>
                              <transform value="copy"/>
                              <parameter>
                                 <valueId value="unit"/>
                              </parameter>
                           </target>
                        </rule>
                        <rule>
                           <name value="unit"/>
                           <source>
                              <context value="value"/>
                              <element value="unit"/>
                              <variable value="unit"/>
                           </source>
                           <target>
                              <context value="Age"/>
                              <contextType value="variable"/>
                              <element value="unit"/>
                              <transform value="copy"/>
                              <parameter>
                                 <valueId value="unit"/>
                              </parameter>
                           </target>
                        </rule>
                        <rule>
                           <name value="system"/>
                           <source>
                              <context value="value"/>
                           </source>
                           <target>
                              <context value="Age"/>
                              <contextType value="variable"/>
                              <element value="system"/>
                              <transform value="copy"/>
                              <parameter>
                                 <valueString value="http://unitsofmeasure.org"/>
                              </parameter>
                           </target>
                        </rule>
                     </rule>
                  </rule>
               </rule>
            </rule>
         </rule>
      </rule>
   </group>
</StructureMap>